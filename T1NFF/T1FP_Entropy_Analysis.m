clear all;
close all;
addpath('../function/');
base_dir = uigetdir;
%%
T1_entropy = [4.155854443	4.583806632	4.315754456	4.088586506	3.87494749	3.922804212	3.857169446	4.002481407	3.546814105	2.934714329	3.64359082	3.492544805	3.09303178	2.969015731	3.150505069	2.612399916	2.707342443	3.348294038	3.252863381	3.910689865	3.940530648	3.545899774	3.818083136	3.192966838	3.85244705	4.440089136	4.230228959	4.087134786	3.73376797	3.966280504	3.657703882	3.358182122	3.329851105	3.16492367	4.015186999	3.52200691	3.982795171	4.506174388	3.909139297	4.387479894	4.034480418	3.802665011	3.298068512	3.96961873	3.847832014	3.432847581	2.754441846	2.521928095	3.431623566];
FF_mean = [15.60447728	14.78351024	12.17616673	8.138109019	6.199221444	6.298566453	6.349978604	3.980585046	4.247593918	4.852949747	4.657240867	5.177199829	1.631045615	2.728173187	2.586949272	2.267199355	1.965339977	3.132784497	3.067722853	3.436115497	3.447189287	4.457039614	3.453607224	1.485206799	10.56805944	11.57662087	12.4761005	6.204056188	6.20985808	7.109428801	8.894293271	5.763136511	8.114717589	4.279872056	2.760749916	3.46983488	8.439058352	12.71780664	3.220006784	9.364701114	7.498762478	3.849234679	3.67828082	2.795359749	3.624650895	2.636651685	1.430597131	3.262081827	4.778726584];
r2star_mean = [62.97160686	61.44405532	54.40868886	48.09030404	49.84719683	44.13125753	48.86915895	33.58955265	38.02172821	41.81526572	39.76389763	44.32598027	40.20305723	36.12753645	33.61147748	36.66169398	25.66525328	35.12353681	39.35319758	37.00863445	36.9487465	45.06678416	37.977241	33.36696338	55.72579252	50.11184238	56.23618837	51.96202513	45.32157871	53.42367437	46.13076239	38.3749292	43.1041654	36.08635756	40.34869025	39.22262539	104.1659527	89.32698057	68.73375711	66.9378156	56.83786406	48.12828032	35.04357941	50.1362844	47.87491294	43.30856064	32.83326505	32.14249061	35.03343475];
LGE_entropy = [3.656983712	3.941199266	4.089784859	3.881284742	3.561233334	3.483935743	3.664229119	3.684560896	3.712323528	2.872692183	3.591349559	3.79807022	3.812485947	3.905203054	3.88953028	3.784297394	3.661828484	3.497389336	3.27292933	3.371202524	3.729770675	3.308398669	2.969344194	3.185402274	3.437481925	3.390369363	3.518518126	3.287219955	3.629044281	3.559846451	3.491380001	3.699868659	3.950789424	3.948536049	3.737666023	3.88516019	3.316607955	3.296621536	3.67518154	3.009576965	3.755538804	3.767331131	3.667713115	3.872188177	3.872188177	3.802597693	3.633783409	3.322179346	3.559900002];
T2_entropy = [4.866092057	4.811894621	5.840433989	4.432160781	4.112835956	3.22613944	4.76240313	7.530005439	4.602192851	2.464847133	6.399507052	3.972468779	2.325802218	2.061957933	2.962648786	2.389154134	2.490009819	2.062835692	2.810696113	3.183656693	1.76707476	4.630844519	8.194104684	2.954269973	3.629364874	4.435301604	3.763519196	3.24022709	3.113596514	2.378387284	1.924354107	2.643060471	4.202585005	3.525448165	3.347837752	4.970213787	8.226919139	6.184411791	3.855676514	5.417537982	3.415685693	4.091868107	2.147422091	3.298517776	2.961022405	2.329226122	1.709147917	2.019035274];
T2_mean = [34.95344828	30.67777778	30.97619048	32.88369565	37.01654676	35.832	36.44820144	40.23121693	38.1	30.67222222	35.85063291	35.27901235	32.83033708	35.74	37.31527778	36.992	38.79032258	38.70470085	38.43084112	36.57607362	34.93373494	45.42808989	50.81202346	44.57482517	33.30759494	30.80294118	32.09134615	33.48412698	35.68367347	37.07824561	37.69902913	34.46447368	37.78611111	39.50854701	34.23253968	44.94833333	39.47894737	33.06161616	38.12216216	44.73380952	33.00943396	38.7976	33.37536232	32.47	32.228125	32.92677165	42.2	39.58];
% exclude_idx = [8 20 21 23 35 39 42 44 45];
% T1_entropy(exclude_idx) = [];
% LGE_entropy(exclude_idx) = [];
% r2star_mean(exclude_idx) = [];
% FF_mean(exclude_idx) = [];

T1_entropy(end) = [];
LGE_entropy(end) = [];
r2star_mean(end) = [];
FF_mean(end) = [];
%%
%T1_entropy = [3.168709023	3.334507442	3.609657142	4.244238204	3.276610872	2.698967964	3.083074189	3.968363503	3.844448154	3.946608368	2.89745019	3.314577897	4.047066435	3.650290875	4.073964724	4.602565424	4.575573574	4.466614505];
%LGE_entropy = [3.484474219	3.436485838	3.557588871	3.305645006	3.309975665	3.429908335	3.636838083	3.876929155	3.918368847	3.837609223	4.057909613	4.094886062	4.078860767	3.815231323	3.659306482	3.884978062	3.870250131	3.522038857];
%FF_mean = [0.636639592	1.865653991	1.345933117	4.900145234	9.719854995	2.401783731	2.684916837	9.320714028	8.943914307	12.04769945	1.422804704	3.184270299	2.554192449	3.709142015	8.029844032	8.898270695	9.783539	7.193383625];
%r2star_mean = [35.12006042	38.67715846	27.49120629	32.12196626	39.13354795	31.92301263	36.87221811	49.67470491	31.80848537	42.11305999	32.28621231	35.33440487	33.33091064	40.43188163	49.88945607	45.34242753	42.89065355	36.42944891];
%T2_entropy = [4.866092057	4.811894621	5.840433989	4.432160781	4.112835956	3.22613944	4.76240313	7.530005439	4.602192851	2.464847133	6.399507052	3.972468779	2.325802218	2.061957933	2.962648786	2.389154134	2.490009819	2.062835692	2.810696113	3.183656693	1.76707476	4.630844519	8.194104684	2.954269973	3.629364874	4.435301604	3.763519196	3.24022709	3.113596514	2.378387284	1.924354107	2.643060471	4.202585005	3.525448165	3.347837752	4.970213787	8.226919139	6.184411791	3.855676514	5.417537982	3.415685693	4.091868107	2.147422091	3.298517776	2.961022405	2.329226122	1.709147917	2.019035274];

T1_entropy = [3.434995204	3.938055327	3.762232561	3.277875859	3.151586898	3.086717588	3.058121378	3.074957238	2.578228703	2.595815638	3.213119346	2.910791296	3.027350691	2.252669124	2.427804709	2.078900194	1.785305929	2.381059023	2.243795798	2.961622881	3.009159374	2.855204435	2.767544556	2.197571944	3.260072675	3.691184573	3.545920887	3.352747155	2.638744434	3.081907058	2.755593336	2.486637372	2.574397452	2.262907233	3.408997009	2.918151106	3.577349186	3.83306413	3.491983393	3.491605214	3.137371244	3.330624871	2.71342767	3.569175429	3.607389089	2.97435778	2.321653449	2.419381946	2.860320778];
FF_mean = [15.60447728	14.78351024	12.17616673	8.138109019	6.199221444	6.298566453	6.349978604	3.980585046	4.247593918	4.852949747	4.657240867	5.177199829	1.631045615	2.728173187	2.586949272	2.267199355	1.965339977	3.132784497	3.067722853	3.436115497	3.447189287	4.457039614	3.453607224	1.485206799	10.56805944	11.57662087	12.4761005	6.204056188	6.20985808	7.109428801	8.894293271	5.763136511	8.114717589	4.279872056	2.760749916	3.46983488	8.439058352	12.71780664	3.220006784	9.364701114	7.498762478	3.849234679	3.67828082	2.795359749	3.624650895	2.636651685	1.430597131	3.262081827	4.778726584];
r2star_mean = [62.97160686	61.44405532	54.40868886	48.09030404	49.84719683	44.13125753	48.86915895	33.58955265	38.02172821	41.81526572	39.76389763	44.32598027	40.20305723	36.12753645	33.61147748	36.66169398	25.66525328	35.12353681	39.35319758	37.00863445	36.9487465	45.06678416	37.977241	33.36696338	55.72579252	50.11184238	56.23618837	51.96202513	45.32157871	53.42367437	46.13076239	38.3749292	43.1041654	36.08635756	40.34869025	39.22262539	104.1659527	89.32698057	68.73375711	66.9378156	56.83786406	48.12828032	35.04357941	50.1362844	47.87491294	43.30856064	32.83326505	32.14249061	35.03343475];
LGE_entropy = [3.656983712	3.941199266	4.089784859	3.881284742	3.561233334	3.483935743	3.664229119	3.684560896	3.712323528	2.872692183	3.591349559	3.79807022	3.812485947	3.905203054	3.88953028	3.784297394	3.661828484	3.497389336	3.27292933	3.371202524	3.729770675	3.308398669	2.969344194	3.185402274	3.437481925	3.390369363	3.518518126	3.287219955	3.629044281	3.559846451	3.491380001	3.699868659	3.950789424	3.948536049	3.737666023	3.88516019	3.316607955	3.296621536	3.67518154	3.009576965	3.755538804	3.767331131	3.667713115	3.872188177	3.872188177	3.802597693	3.633783409	3.322179346	3.559900002];
exclude_idx_ff = FF_mean < 4;
exclude_idx_r2star = r2star_mean < 40;

exclude_idx_ff = FF_mean >= 4;
exclude_idx_r2star = r2star_mean >= 40;
exclude_idx = exclude_idx_ff | exclude_idx_r2star;

%exclude_idx = [];
T1_entropy(exclude_idx) = [];
LGE_entropy(exclude_idx) = [];
r2star_mean(exclude_idx) = [];
FF_mean(exclude_idx) = [];

%% For All chronic timepoints
% Weighted, 40 bins
T1_entropy = [3.292015467	3.783864573	2.973529192	2.563597534	3.623484896	4.039070068	3.521463398	3.434995204	3.938055327	3.762232561	3.277875859	3.242358077	2.960718726	2.971889596	2.802255103	2.869634886	3.151586898	3.086717588	3.058121378	3.074957238	2.578228703	3.295680752	3.382698877	2.956554086	2.763665867	2.595815638	3.213119346	2.910791296	3.027350691	3.415119561	3.049826019	2.827704325	3.329855847	2.252669124	2.427804709	2.078900194	1.785305929	1.986330983	2.162572264	2.073256383	2.641822704	2.381059023	2.243795798	2.961622881	3.009159374	2.27613887	1.481916078	2.855204435	2.767544556	2.197571944	2.328955153	3.447057878	3.819486644	3.364619	3.415637825	3.653883869	3.782141879	3.519648062	3.260072675	3.691184573	3.545920887	3.352747155	2.638744434	3.081907058	2.755593336	2.521004546	1.905956725	2.476013596	2.486637372	2.574397452	2.262907233	3.353903554	3.636646253	2.874416194	3.267397732	3.408997009	2.918151106	3.577349186	3.83306413	3.491983393	2.594694996	3.672898514	3.262030675	3.193682288	2.792275342	3.491605214	3.137371244	3.330624871	2.71342767	3.590609451	3.364294755	3.349767401	3.569175429	3.607389089	2.97435778	2.321653449	2.419381946	2.860320778];


% Remove 2 pixels
% T1_entropy = [3.226650665	3.457850828	2.718079221	2.499056589	3.371479193	3.195670399	3.064785548	2.804755242	2.975664237	3.392783749	3.377906439	3.008738456	2.98838875	2.844429901	2.832724493	2.697805734	2.822762112	3.029865506	2.81136788	2.954446942	2.725400327	2.409891914	2.474903441	2.778625884	2.656873042	2.252382635	2.70835284	3.030668964	2.639595553	2.359077838	3.071203999	2.84446803	2.436041881	2.763742186	1.992180025	2.203703282	1.993940438	1.785305929	1.986330983	2.02325357	1.998485279	2.457795368	2.290983872	2.198052043	2.581775734	2.678328269	2.115803637	1.332820405	2.516182382	2.625713045	2.010239527	1.914737636	3.197997566	3.505325142	3.074497691	3.089220972	2.908192061	2.84738103	2.937687855	2.596840402	3.000211946	3.169069808	2.994413901	2.524967107	2.998447499	2.565253142	2.20212135	1.835902812	2.329831286	2.427465917	2.198021807	1.87599672	3.175221734	3.322749077	2.377708927	3.182048804	2.95398955	2.545954336	2.951999651	3.290760029	3.080862045	2.380860235	3.293971748	3.007071329	2.189238256	2.485228136	3.241956654	2.850966975	2.509007051	1.557431962	3.330939307	3.090225788	3.0843122	3.30905914	3.409117229	2.773133387	1.959298911	0	1.554585169];

% Remove 1 pixel
% T1_entropy = [3.292015467	3.521195067	2.79463277	2.499056589	3.445044499	3.621144808	3.297626439	2.892417091	3.066471628	3.462203302	3.592682664	3.177138664	3.0530908	2.897942434	2.896518766	2.697805734	2.822762112	3.085583319	2.92440905	3.019313842	2.947289192	2.487492159	2.979806954	3.133844038	2.753393644	2.505249493	2.474903441	2.778625884	2.812441399	2.815071955	3.284571717	3.049826019	2.737397331	3.024822002	1.992180025	2.203703282	1.993940438	1.785305929	1.986330983	2.111291841	1.998485279	2.572645343	2.290983872	2.198052043	2.758429824	2.932287882	2.115803637	1.332820405	2.516182382	2.691009153	2.010239527	2.105397711	3.353331226	3.701725673	3.228027809	3.203343525	3.465365569	3.524141992	3.210316365	3.018648943	3.405099327	3.321758834	3.099583357	2.59655574	2.998447499	2.652450464	2.373915237	1.835902812	2.329831286	2.427465917	2.436638708	1.87599672	3.175221734	3.41357256	2.694810802	3.267397732	3.105601702	2.641704474	3.344269698	3.454493031	3.199919752	2.380860235	3.376717816	3.097800573	2.425098369	2.672905595	3.373857357	2.953169881	2.980240673	2.127065631	3.449855635	3.235358758	3.349767401	3.374464205	3.607389089	2.928387789	1.959298911	0.970950594	1.924174352];

% unweighted, 40 bins
% T1_entropy = [3.537273219	4.032394521	3.326644545	3.008024795	3.927864033	4.258540624	3.857469858	3.479601779	3.799957565	4.233525404	4.002220303	3.694694354	3.571369543	3.598695476	3.482047247	3.367627438	3.436607051	3.43726271	3.513891595	3.47255582	3.540584069	3.085670113	3.288293569	3.593676212	3.259061911	2.704099781	2.617536533	3.276420835	3.067476457	2.652345561	3.928134475	3.478835254	3.43127238	3.768273847	2.4758585	2.74216951	2.303627993	2.232848992	2.383988609	2.682792823	2.516696304	3.079797834	2.906915359	2.826764657	3.365261528	3.604876133	2.936911074	2.214199695	3.118697829	3.342514592	2.697405766	2.556359143	3.502596841	4.049195895	3.654991497	3.415678079	3.694891829	4.018089708	3.975646384	3.30708252	4.047772969	3.940762991	3.723397038	3.237951205	3.56244661	3.198341371	2.739881706	2.271066057	2.561964212	2.893388358	2.879451104	2.765574736	3.190119875	3.52847719	3.197407646	3.392662215	3.714523193	3.109386672	3.564926018	4.125803243	3.501826416	2.928782852	4.001909518	3.65633558	3.374548236	2.96147252	3.995461119	3.552783151	3.358922883	3.269576746	3.66462172	3.290420494	3.343119911	3.55559154	3.427307576	3.022182094	2.307820398	2.05881389	3.090032777];

% unweighted remove 1 pixels
% T1_entropy = [3.537273219	3.782380131	3.286405173	2.888662706	3.84755692	3.864413376	3.777840376	3.432148197	3.366493661	3.944728716	3.725613275	3.458720552	3.394581786	3.484402087	3.447749151	3.226404779	3.352014857	3.310557034	3.394060013	3.436646427	3.463385702	3.044935395	3.137126814	3.294681477	2.934717607	2.532314007	2.36559623	3.029408653	2.772208352	2.41268789	3.692190757	3.421283068	3.356971263	3.56895206	2.288466328	2.529550926	2.220323638	2.15218353	2.383988609	2.588147006	2.446481784	3.014843837	2.781837408	2.785245314	3.273114274	3.604876133	2.796907293	2.086641775	2.962271231	3.308123598	2.697405766	2.236779563	3.3193688	3.898256069	3.570623578	3.131673258	3.239668316	3.617076226	3.840960127	3.074820572	3.896728115	3.73576803	3.494882387	3.08415993	3.486437276	3.103631795	2.64618737	2.271066057	2.354435538	2.83859057	2.751154309	2.560352492	3.065543713	3.360131473	3.030869578	3.340515087	3.388982986	2.898502483	3.324424043	3.818738355	3.140864629	2.627413428	3.824450462	3.554838897	2.503997527	2.727827978	3.89027626	3.327108655	3.103347507	2.935649892	3.525242792	3.247439407	3.303235567	3.479055348	3.427307576	2.975447368	1.94400975	0.918295834	2.235926351];

% Unweighted, 20 bins
T1_entropy = [2.574698565	3.11641416	2.358427424	2.111429903	2.978402775	3.347837177	2.96493762	2.894477301	3.259330177	3.115440133	2.766654228	2.611181993	2.602057079	2.524576516	2.406260566	2.496369982	2.538348015	2.509035772	2.48490349	2.585283285	2.148374255	2.398838914	2.648555312	2.402159542	1.839126497	1.622556249	2.368758408	2.256482054	1.903881788	2.997549072	2.689013128	2.520381504	2.902648639	1.608617724	1.961731166	1.490580398	1.360946274	1.447984595	1.83254541	1.572194612	2.203974463	1.919007873	1.870708629	2.587282248	2.816679246	2.041220906	1.243180398	2.188882993	2.38232161	1.800000911	1.729393449	2.549083431	3.112251948	2.690413038	2.448794937	2.799663983	3.151489355	3.076284397	2.523777569	3.121384648	3.038978984	2.781351419	2.325361734	2.543999705	2.297340406	1.881329453	1.220375637	1.62548643	1.93954513	2.001699743	1.835828979	2.509446836	2.606201621	2.257344893	2.549007671	2.747476322	2.19547983	2.732843101	3.221968463	2.621932649	2.187450335	3.111954791	2.733228663	2.609931016	2.162927762	3.004677481	2.661841933	2.472334338	2.31850778	2.737490158	2.371470134	2.427307582	2.619791797	2.490255144	2.080386854	1.717040781	1.224394445	2.294274067];

FF_mean = [8.67898015	6.254385141	3.163614774	2.668638449	10.8550361	14.04099999	16.97053298	15.60447728	14.78351024	12.17616673	8.138109019	6.817493369	4.872403662	3.686957353	3.121698421	3.789357016	6.199221444	6.298566453	6.349978604	3.980585046	4.247593918	4.548496437	5.296721288	5.879011562	1.701985082	4.852949747	4.657240867	5.177199829	1.631045615	1.617945671	2.868202953	0.57090047	2.862495792	2.728173187	2.586949272	2.267199355	1.965339977	2.662233876	3.587132183	3.773357303	3.1280887	3.132784497	3.067722853	3.436115497	3.447189287	2.551688089	1.972721009	4.457039614	3.453607224	1.485206799	9.884391748	6.97808652	5.563248478	6.763654469	9.737753159	10.52630823	9.897422831	10.19417579	10.56805944	11.57662087	12.4761005	6.204056188	6.20985808	7.109428801	8.894293271	3.431069405	2.016370513	1.012086171	5.763136511	8.114717589	4.279872056	5.791892352	6.859122164	4.279127297	7.951895703	2.760749916	3.46983488	8.439058352	12.71780664	3.220006784	2.680067088	10.1953705	7.028997074	4.972657679	4.079221614	9.364701114	7.498762478	3.849234679	3.67828082	3.011781264	3.011781264	1.87500241	2.795359749	3.624650895	2.636651685	1.430597131	3.262081827	4.778726584];
r2star_mean = [61.66396949	66.72801911	50.38543069	49.13664347	61.92823034	67.09022474	56.0265886	62.97160686	61.44405532	54.40868886	48.09030404	41.94485716	36.68863286	61.51613479	34.331597	35.26857996	49.84719683	44.13125753	48.86915895	33.58955265	38.02172821	43.66634368	45.68736055	51.37058864	41.99326427	41.81526572	39.76389763	44.32598027	40.20305723	20.62063077	34.15637537	32.2809834	33.40768945	36.12753645	33.61147748	36.66169398	25.66525328	38.247155	33.68132133	35.85678127	37.84415544	35.12353681	39.35319758	37.00863445	36.9487465	36.67803083	37.61043845	45.06678416	37.977241	33.36696338	63.3389743	65.71483958	72.28083434	56.24927084	54.09668959	51.64011137	51.37432136	46.7566622	55.72579252	50.11184238	56.23618837	51.96202513	45.32157871	53.42367437	46.13076239	44.17880923	43.03302699	35.28729478	38.3749292	43.1041654	36.08635756	47.53581232	48.63565039	46.02452838	38.34390915	40.34869025	39.22262539	104.1659527	89.32698057	68.73375711	46.10527221	66.09715616	59.76106088	50.18403992	45.89983436	66.9378156	56.83786406	48.12828032	35.04357941	48.68408956	48.68408956	43.02469319	50.1362844	47.87491294	43.30856064	32.83326505	32.14249061	35.03343475];
LGE_entropy = [3.919292542	4.110784112	4.089974654	3.810200708	3.846419175	3.924069395	3.902059585	3.870858235	4.07271552	4.109600022	3.991972408	3.55626904	3.716552049	3.58165343	3.801258766	3.861091469	3.903447958	3.857795248	3.924375674	3.998552725	3.854297105	3.630008655	3.716048169	3.787515764	3.744452936	3.800961858	3.708158957	4.109147895	3.912950805	3.658307272	3.579709702	3.411269011	3.524858076	3.909323454	3.976122474	3.766064815	3.732822447	3.936883259	3.714602979	3.856571364	3.727014989	3.920935007	3.500835396	3.921629125	3.744673551	3.868735721	3.656300872	3.818267946	3.894800055	3.535505743	4.019492796	3.862468727	3.89402203	3.812185276	3.744416443	3.893930839	3.992244852	3.918095732	3.866078746	3.97073485	3.944800313	3.789156797	3.797879395	3.687910764	3.712346131	3.843611986	3.97440545	3.669000969	3.722775933	4.041433827	3.949428307	3.929890893	3.889734359	3.837547193	3.835833493	4.001945187	4.039818756	3.485067125	3.972056199	4.031901369	4.016952846	3.504339045	3.984042202	3.921238236	3.834988021	3.093944588	3.769546283	4.089783055	3.858992869	4.149593829	4.05998882	4.010941276	4.024992838	4.024992838	3.924686676	3.771527784	3.236857303	3.488525295];
T2_mean = [35.73141593	33.65185185	36.2531401	37.49791667	33.84610169	31.33308824	33.07565982	34.95344828	30.67777778	30.97619048	32.88369565	37.26329114	36.15433526	39.67062147	41.66467066	35.97469136	37.01654676	35.832	36.44820144	40.23121693	38.1	36.75977011	34.11805556	36.82105263	39.25058824	30.67222222	35.85063291	35.27901235	32.83033708	37.63902439	34.94651163	34.87884615	42.80519481	35.74	37.31527778	36.992	38.79032258	41.92209302	42.43303965	39.26888889	39.3828125	38.70470085	38.43084112	36.57607362	34.93373494	37.15578231	41.98053691	45.42808989	50.81202346	44.57482517	34.77634409	34.2490099	31.89351351	31.71322751	33.26290323	33.10379747	29.2627907	32.53714286	33.30759494	30.80294118	32.09134615	33.48412698	38.36223776	35.68367347	37.07824561	34.49954751	31.49328859	29.97372263	34.46447368	37.78611111	39.50854701	37.10631579	36.1956044	37.21166667	34.87608696	34.23253968	44.94833333	39.47894737	33.06161616	38.12216216	38.5125	37.14335664	33.948	38.85479452	34.64666667	44.73380952	33.00943396	38.7976	33.37536232	35.14545455	34.14265734	32.81756757	32.47	32.228125	32.92677165	33.61666667	37.98518519	39.2];
T1_mean = [1188.030534	1231.571429	1244.289063	1253	1238.240741	1210.397849	1239.552632	1247.231579	1240.596774	1232.391304	1272.680412	1230.860927	1349.233503	1317.391026	1315.461538	1340.615385	1234.606557	1266.746032	1215.628378	1269.82963	1238.860294	1157.254545	1191.208333	1201.549296	1136.527273	1171.294118	1152.04	1173.5	1128.472222	1398.142857	1344.540541	1357.68	1304.037037	1132.917526	1161.135135	1121.179104	1137.507246	1236.233645	1223.196721	1214.12987	1224.135135	1217.198582	1233.151079	1257.588785	1262.894737	1357.328358	1256.8	1202.6	1312.226415	1230.882353	1184.111111	1171.688679	1221.016667	1218.283186	1114.542373	1132.634921	1202.987805	1278.043478	1138.113208	1217.135135	1212.564815	1196.351351	1267.375	1297.909774	1286.614679	1210.398438	1199.294737	1173.230769	1236.350515	1224.948718	1197.864865	1127.302632	1143.594937	1164.363636	1172.08046	1176.710744	1177.376238	1194.680851	1218.494737	1224.775862	1366.738095	1290.521277	1295.114943	1214.433333	1246.419355	1365.908397	1325.428571	1197.956522	1228.566667	1125.738255	1141.071429	1166.573529	1158.844444	1127.158333	1159.008475	1147.136364	1141.7	1248.105263];
dfp_treated_label = [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1,...
    1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0];
hemo_label = [1	1	1	0	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	0	0	1	1	0	0	1	0	1	1	1	1	1	1	1	1	1	0	1	1	0	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	0	0	1];

r2star_mean_core = [61.94307828	76.18135322	59.87638549	0	64.67146453	68.18503134	62.58521901	0	63.074596	69.00121096	58.57586781	52.44060189	45.65815824	41.06407289	76.54461979	40.30648736	42.38267662	46.64519181	56.46477305	54.71190635	38.51559833	39.23125351	44.43670648	48.21565244	46.20186406	43.87674857	47.8662608	53.48974484	55.13819647	44.42573949	0	0	35.08285907	57.72704076	0	0	51.00690437	0	41.55915137	32.26982206	40.97986235	40.49371765	33.70151854	47.53551184	49.40957938	41.55422674	41.20528461	0	59.29470013	47.65263222	0	66.70692886	74.22914318	76.70050628	68.2719432	72.67829265	55.37004556	59.03588732	49.5543491	61.6618463	57.35343764	61.51215175	60.57790793	52.59371398	63.96942263	70.62443949	49.9444309	44.72319865	60.33931248	41.21062379	50.15432889	43.08639105	58.80959883	59.45235923	53.23263297	49.41202765	47.05307283	43.88494615	104.1659527	105.3735606	71.3822877	55.18135139	87.10114117	77.5029901	58.72351064	50.30429298	71.734744	58.91634099	55.35176295	37.33161715	62.2854226	0	55.91131405	56.37855216	57.49797238	52.77414554	0	0	38.99169973];

T1_entropy_remote = [0.902393283	0.849751137	1.114998556	0.988699408	0.485460761	1.241946032	1.351644115		0.811278124	0.976020648	1.301574289	1.238278588	0.887306883	1.108210671	1.320876965	0.974153928	1.773671253	1.505240815	0.99631652	1.244301399	1.605238891	1.08132478	1.387689293	1.667339571	1.670548561	1.742737649	1.236386411	0.987692509	1.383912263	1.459613152	0.99107606	0.954434003	1.399355668	1.398235275	1	0.99107606	0.988699408	1.820026002	1.121640762	0.868392729	0.702466551	0.950956048	2.067869209	1.398661573	0.991760148	0.908653934	0.998000884	0.828055725	0.998635964	1.104307786	0.831474388	1.052981575	0.995727452	0.791858353	1	1.223000838	0.999010271	0.757878463	0.881290899	1.413088436	1.074627699	1.357676647	1.903716451	0.690695056	0.981152234	0.999337504	0.721928095	1.128799767	0.908178347	1.360964047	0.997502546	1.287054028	1.264672679	1.697320659	1.45356453	1.202292189	1.427482563	1.199460293	0.870864469	1.094767966	1.161378479	0.968164732	1.598816797	0.816689088	0.79732651	0.857148437	1.288649765	1.446616668	1.253801391	0.888885776	1.44524582	1.594874843	1.570671012	1.06761116	1.52623491	0.799048521	0.831543549	1.176679668	0.918295834];


name_label = {'Merry_6MO', 'Merry_6MO', 'Merry_6MO', 'Merry_6MO', 'Merry_1YR', 'Merry_1YR', 'Merry_1YR', 'Merry_15YR', 'Merry_15YR', 'Merry_15YR', 'Merry_15YR',...
    'Ryn_9MO', 'Ryn_9MO', 'Ryn_9MO', 'Ryn_9MO', 'Ryn_9MO', 'Ryn_1YR', 'Ryn_1YR', 'Ryn_1YR', 'Ryn_1YR', 'Ryn_1YR',...
    'Mojave_9MO', 'Mojave_9MO', 'Mojave_9MO', 'Mojave_9MO', 'Mojave_1YR', 'Mojave_1YR', 'Mojave_1YR', 'Mojave_1YR',...
    'Sahara_9MO', 'Sahara_9MO', 'Sahara_9MO', 'Sahara_9MO', 'Sahara_1YR', 'Sahara_1YR', 'Sahara_1YR', 'Sahara_1YR',...
    'ZZ_6MO', 'ZZ_6MO', 'ZZ_6MO', 'ZZ_6MO', 'ZZ_1YR', 'ZZ_1YR', 'ZZ_1YR', 'ZZ_1YR',...
    'Tina_6MO', 'Tina_6MO', 'Tina_1YR', 'Tina_1YR', 'Tina_1YR',...
    'Sunny_6MO', 'Sunny_6MO', 'Sunny_6MO', 'Sunny_6MO', 'Sunny_1YR', 'Sunny_1YR', 'Sunny_1YR', 'Sunny_1YR', 'Sunny_15YR', 'Sunny_15YR', 'Sunny_15YR', 'Sunny_15YR'};

find(abs(zscore(T1_entropy))>3)
find(abs(zscore(FF_mean))>3)     % 7, 8
find(abs(zscore(r2star_mean))>3) % 79, 80
find(abs(zscore(LGE_entropy))>3) % 87, 98
find(abs(zscore(T2_mean))>3) % 50

find(abs(zscore(T1_entropy))>2.5)  % 48
find(abs(zscore(FF_mean))>2.5)     % 7, 8, 9
find(abs(zscore(r2star_mean))>2.5) % 79, 80
find(abs(zscore(LGE_entropy))>2.5) % 87, 98
find(abs(zscore(T2_mean))>2.5) % 50

find(abs(zscore(T1_entropy))>2)  % 38, 48, 68
find(abs(zscore(FF_mean))>2)     % 6, 7, 8, 9, 10
find(abs(zscore(r2star_mean))>2) % 31, 79, 80
find(abs(zscore(LGE_entropy))>2) % 33, 87, 98
find(abs(zscore(T2_mean))>2) % 49, 50, 51, 78, 87

exclude_idx_ff = zeros(1, length(FF_mean)) > 0;
exclude_idx_r2star = zeros(1, length(r2star_mean)) > 0;
exclude_idx = zeros(1, length(FF_mean)) > 0;


% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean < 35; % T1_entropy = 2.5968
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean >= 35; % T1_entropy = 2.1776

% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean >= 35;
% 
exclude_idx_ff = FF_mean >= 4;
exclude_idx_r2star = r2star_mean < 35; % T1_entropy = 2.1552

% exclude_idx_r2star = r2star_mean < 40;
exclude_idx_hemo = hemo_label;
exclude_idx = exclude_idx_ff | exclude_idx_r2star;

%exclude_idx = exclude_idx_ff | exclude_idx_r2star | exclude_idx_hemo;

% 2.5SD
% exclude_idx(7) = 1;
% exclude_idx(8) = 1;
% exclude_idx(9) = 1;
% exclude_idx(48) = 1;
% exclude_idx(87) = 1;
% exclude_idx(98) = 1;
% exclude_idx(79) = 1;
% exclude_idx(80) = 1;
% 

% excluded by T1-entropy and FF
%exclude_idx(8) = 1;
exclude_idx(52) = 1;
exclude_idx(66) = 1;
exclude_idx(71) = 1;

% excluded by T1-entropy and r2star
exclude_idx(79) = 1;
exclude_idx(68) = 1;

% excluded by image quality
exclude_idx(80) = 1;

%exclude_idx(7) = 1;
%exclude_idx(9) = 1;
exclude_idx(54) = 1;
exclude_idx(78) = 1;


% exclude_idx(64) = 1;
% exclude_idx(74) = 1;
% exclude_idx(79) = 1;
% exclude_idx(80) = 1;



% 
% % excluded by T1-entropy and LGE-entropy
% exclude_idx(87) = 1;
% exclude_idx(98) = 1;
% 
% % % exclude by T1-entropy and T2-mean
% exclude_idx(50) = 1;
% exclude_idx(49) = 1;
exclude_idx(51) = 1;
%exclude_idx(27) = 1;
%exclude_idx(69) = 1;
% 
% % exclude for T1-entropy and R2star
% exclude_idx(31) = 1;

% After 20 bins
% exclude_idx(51) = 1;
% exclude_idx(79) = 1;
% exclude_idx(68) = 1;
% 
% % exclude for FF and R2star
exclude_idx(53) = 1;

T1_entropy(exclude_idx) = [];
r2star_mean(exclude_idx) = [];
FF_mean(exclude_idx) = [];
LGE_entropy(exclude_idx) = [];
T2_mean(exclude_idx) = [];
T1_mean(exclude_idx) = [];

dfp_treated_label(exclude_idx) = [];

r2star_mean_core(exclude_idx) = [];

T1_entropy_remote(exclude_idx) = [];

%% Five groups
T1_entropy_D3 = [2.424488124	2.710957282	1.878550529	1.951070046	2.411801031	2.35014865	2.14346753	2.128422319	1.78580065	1.732514268	1.936061489	2.134918486	2.336198041	2.048828196	2.619218063	2.876269861	2.070776605	1.996550061	1.908763802	2.679544231	1.966130428	2.329880988	2.53012836	2.343472956	1.947250004	2.09282269	2.140879579	2.227843545	2.05292506	2.112585359	1.851362129	1.944217878	2.275530347	2.122314823	2.031043283	1.980534838	2.599586711	2.280262764	1.821295477	1.825962216	1.758097657	1.59552151];
FF_mean_D3 = [3.44989934	4.309758392	2.891124297	2.237020123	2.710327057	1.920019493	2.969904894	2.205060802	3.721276153	3.503736587	2.574970358	1.252869906	1.174807682	1.979236023	2.240504083	2.683450066	2.400168564	2.680052569	1.385109348	3.890058252	3.2879942	5.496466848	7.687899478	5.070944437	2.118808539	2.112140336	2.138564252	1.835908857	6.152626476	3.298827662	3.253063542	4.308123005	4.227695686	3.313521815	2.493417894	4.365479681	7.073946549	4.089323039	3.247974872	1.821345925	2.399749313	3.333141136];
r2star_mean_D3 = [72.73675128	78.87482801	34.16126706	35.4632928	60.27777347	54.51845302	39.08684261	46.1216507	39.88690393	31.73431821	33.45233729	26.41899324	40.64079054	22.61144314	58.25644818	57.38864535	62.20136304	49.54103853	43.32831188	40.97485312	62.76547308	58.59285304	51.65697127	44.67415413	38.26492644	32.49358503	33.4185714	45.52160523	48.0663933	30.0051874	29.35370961	68.93006195	48.48585031	46.69300627	43.77514529	79.83395509	72.37015529	52.27868211	79.79926478	48.95698438	52.88780263	57.35658662];

T1_entropy_D7 = [2.3270653	2.6351239	2.55830212	2.51351336	1.93226892	2.05447397	2.22141596	2.19808283	2.31467648	2.41055015	2.36141344	2.25615024	1.44122607	1.99592392	2.13185804	1.82649511	1.75582047	2.37392399	2.81416658	1.7109774	1.93642105	1.93320213	2.30851289	2.14372261	2.3615575	1.95820163	1.89192997	1.9204882	2.26718518	2.27063735	2.33346801	2.21346391	2.23057465	2.2608204	1.73704882	1.85644008	1.88784253	2.0300023	2.19460803	1.87614719	2.4502785	1.76618178	2.14082655];
FF_mean_D7 = [2.47430805	2.49983508	3.02509153	2.44678791	3.76053492	2.75874909	2.82881517	2.09941827	2.24035466	3.04862627	3.0238995	1.67103834	1.01029242	1.16884511	0.89180163	1.56504518	1.52873095	1.83287417	1.70702519	4.27759991	4.48180427	5.79823726	5.52513204	2.1262778	1.98187149	2.58688163	1.96187887	2.37473548	2.64488583	3.07885622	2.77052554	2.29448874	6.22184026	9.74640883	3.06765005	4.55195609	4.79050207	1.64288447	2.93573	2.08117281	1.68992064	1.00067138	1.21857667];
r2star_mean_D7 = [61.7443254	58.7306486	48.7774408	35.8147248	73.3297559	59.59091	41.4159508	35.7163385	26.3256328	28.4898857	36.3859119	37.7430217	27.4617696	24.8507618	26.3734164	20.4331827	37.8272333	42.1997185	47.6060369	55.1440965	66.0857956	57.0102828	55.4041633	37.7206837	26.7092659	26.231447	31.7430357	34.0342945	30.3936242	36.3179821	65.3912804	51.8935618	51.8388923	88.3537511	81.4796063	71.8215389	60.9944584	42.4653495	27.1520957	40.095634	59.6535796	54.2157366	45.2272068];

T1_entropy_WK8 = [2.30600536	2.55602519	2.38048924	2.13423362	2.27547237	2.49500705	2.00724972	2.48041231	1.98870744	2.03099104	1.90232569	1.99124557	1.94470134	1.98764716	1.30005978	1.18739694	1.73569	1.84010894	1.783844	1.87315992	1.87980763	1.82795453	1.27383932	2.46807372	2.46424814	2.12752954	1.93974829	2.15747881	1.93074764	2.15862443	1.54812111	1.2962839	1.48984342	2.49841326	2.13267576	1.45311011	2.39087883	2.38303679	1.88947923	1.35719678	2.36520855	2.12826539	2.02496627	1.99264977	2.31530806	2.3664579	2.11695125	2.33492328	1.64832556	1.83992073];
FF_mean_WK8 = [4.49257648	3.3074353	3.12300383	1.05480846	2.76963646	2.09577332	2.74304128	3.79477402	6.08463019	1.72302442	1.53241404	0.77163917	1.7229371	2.92593365	1.70482894	1.898947	1.54265076	2.09087656	1.98897644	2.23229746	2.17484946	1.70834787	1.3411463	4.1319575	3.39791967	4.20057766	2.93916433	2.05605995	2.38906333	1.90025803	3.59624771	3.58971809	2.18528911	2.44311322	1.66001883	1.98643226	5.46237013	7.91720432	3.23251487	2.54903982	3.8436192	2.38004175	2.36595762	1.27983971	1.41921855	1.29740078	1.38238742	1.37456018	1.13060704	2.09067171];
r2star_mean_WK8 = [62.4524916	71.8957378	72.0249301	79.1715514	46.1455892	39.8367344	66.1553202	61.3746271	59.3532675	67.2855593	71.6642686	55.3020391	46.502739	36.1761393	37.396867	38.9212733	27.1830075	28.3359075	30.2085757	33.162167	40.4282986	30.5762464	44.6263179	79.5385601	76.0684688	88.8420424	63.5930618	52.4039776	60.5070557	40.9185196	56.4762953	49.0185292	47.4707881	56.3342326	43.5032227	48.1334092	70.4070237	76.0941582	64.1415397	59.3153461	58.1214408	40.2575583	62.2695687	65.4181257	60.9843065	61.9548242	62.5291875	33.8462301	29.6957219	36.4636009];

T1_entropy_M6 = [2.574698565	3.11641416	2.358427424	2.111429903	1.447984595	1.83254541	1.572194612	2.203974463	2.041220906	1.243180398	1.729393449	2.549083431	3.112251948	2.690413038	2.325361734	2.543999705	2.297340406	1.881329453	1.220375637	1.62548643	2.732843101	3.221968463	2.621932649	2.187450335	1.717040781	1.224394445	2.294274067];
FF_mean_M6 = [8.67898015	6.254385141	3.163614774	2.668638449	2.662233876	3.587132183	3.773357303	3.1280887	2.551688089	1.972721009	9.884391748	6.97808652	5.563248478	6.763654469	6.20985808	7.109428801	8.894293271	3.431069405	2.016370513	1.012086171	8.439058352	12.71780664	3.220006784	2.680067088	1.430597131	3.262081827	4.778726584];
r2star_mean_M6 = [61.66396949	66.72801911	50.38543069	49.13664347	38.247155	33.68132133	35.85678127	37.84415544	36.67803083	37.61043845	63.3389743	65.71483958	72.28083434	56.24927084	45.32157871	53.42367437	46.13076239	44.17880923	43.03302699	35.28729478	104.1659527	89.32698057	68.73375711	46.10527221	32.83326505	32.14249061	35.03343475];

T1_entropy_Y1 = [2.978402775	3.347837177	2.96493762	2.894477301	3.259330177	3.115440133	2.766654228	2.611181993	2.602057079	2.524576516	2.406260566	2.496369982	2.538348015	2.509035772	2.48490349	2.585283285	2.148374255	2.398838914	2.648555312	2.402159542	1.839126497	1.622556249	2.368758408	2.256482054	1.903881788	2.997549072	2.689013128	2.520381504	2.902648639	1.608617724	1.961731166	1.490580398	1.360946274	1.919007873	1.870708629	2.587282248	2.816679246	2.188882993	2.38232161	1.800000911	2.448794937	2.799663983	3.151489355	3.076284397	2.523777569	3.121384648	3.038978984	2.781351419	1.93954513	2.001699743	1.835828979	2.509446836	2.606201621	2.257344893	2.549007671	2.747476322	2.19547983	3.111954791	2.733228663	2.609931016	2.162927762	3.004677481	2.661841933	2.472334338	2.31850778	2.737490158	2.371470134	2.427307582	2.619791797	2.490255144	2.080386854];
FF_mean_Y1 = [10.8550361	14.04099999	16.97053298	15.60447728	14.78351024	12.17616673	8.138109019	6.817493369	4.872403662	3.686957353	3.121698421	3.789357016	6.199221444	6.298566453	6.349978604	3.980585046	4.247593918	4.852949747	4.657240867	5.177199829	1.631045615	4.548496437	5.296721288	5.879011562	1.701985082	1.617945671	2.868202953	0.57090047	2.862495792	2.728173187	2.586949272	2.267199355	1.965339977	3.132784497	3.067722853	3.436115497	3.447189287	4.457039614	3.453607224	1.485206799	9.737753159	10.52630823	9.897422831	10.19417579	10.56805944	11.57662087	12.4761005	6.204056188	5.763136511	8.114717589	4.279872056	5.791892352	6.859122164	4.279127297	7.951895703	2.760749916	3.46983488	10.1953705	7.028997074	4.972657679	4.079221614	9.364701114	7.498762478	3.849234679	3.67828082	5.218695773	3.011781264	1.87500241	2.795359749	3.624650895	2.636651685];
r2star_mean_Y1 = [61.92823034	67.09022474	56.0265886	62.97160686	61.44405532	54.40868886	48.09030404	41.94485716	36.68863286	61.51613479	34.331597	35.26857996	49.84719683	44.13125753	48.86915895	33.58955265	38.02172821	43.66634368	45.68736055	51.37058864	41.99326427	41.81526572	39.76389763	44.32598027	40.20305723	20.62063077	34.15637537	32.2809834	33.40768945	36.12753645	33.61147748	36.66169398	25.66525328	35.12353681	39.35319758	37.00863445	36.9487465	45.06678416	37.977241	33.36696338	54.09668959	51.64011137	51.37432136	46.7566622	55.72579252	50.11184238	56.23618837	51.96202513	38.3749292	43.1041654	36.08635756	47.53581232	48.63565039	46.02452838	38.34390915	40.34869025	39.22262539	66.09715616	59.76106088	50.18403992	45.89983436	66.9378156	56.83786406	48.12828032	35.04357941	48.67224995	48.68408956	43.02469319	50.1362844	47.87491294	43.30856064];

%%
figure('Position', [0 100 900 150]);
subplot(1,5,1);
scatter(FF_mean_D3, r2star_mean_D3); ylim([0 100]); xlim([0 20]);
subplot(1,5,2);
scatter(FF_mean_D7, r2star_mean_D7); ylim([0 100]); xlim([0 20]);
subplot(1,5,3);
scatter(FF_mean_WK8, r2star_mean_WK8); ylim([0 100]); xlim([0 20]);
subplot(1,5,4);
scatter(FF_mean_M6, r2star_mean_M6); ylim([0 100]); xlim([0 20]);
subplot(1,5,5);
scatter(FF_mean_Y1, r2star_mean_Y1); ylim([0 100]); xlim([0 20]);

figure('Position', [0 100 900 150]);
subplot(1,5,1);
scatter(r2star_mean_D3, FF_mean_D3); xlim([0 100]); ylim([0 20]);
subplot(1,5,2);
scatter(r2star_mean_D7, FF_mean_D7); xlim([0 100]); ylim([0 20]);
subplot(1,5,3);
scatter(r2star_mean_WK8, FF_mean_WK8); xlim([0 100]); ylim([0 20]);
subplot(1,5,4);
scatter(r2star_mean_M6, FF_mean_M6); xlim([0 100]); ylim([0 20]);
subplot(1,5,5);
scatter(r2star_mean_Y1, FF_mean_Y1); xlim([0 100]); ylim([0 20]);

figure('Position', [0 100 900 150]);
subplot(1,5,1);
scatter(FF_mean_D3, T1_entropy_D3); xlim([0 20]); ylim([0 4]);
subplot(1,5,2);
scatter(FF_mean_D7, T1_entropy_D7); xlim([0 20]); ylim([0 4]);
subplot(1,5,3);
scatter(FF_mean_WK8, T1_entropy_WK8); xlim([0 20]); ylim([0 4]);
subplot(1,5,4);
scatter(FF_mean_M6, T1_entropy_M6); xlim([0 20]); ylim([0 4]);
subplot(1,5,5);
scatter(FF_mean_Y1, T1_entropy_Y1); xlim([0 20]); ylim([0 4]);

figure('Position', [0 100 900 150]);
subplot(1,5,1);
scatter(r2star_mean_D3, T1_entropy_D3); xlim([0 100]); ylim([0 4]);
subplot(1,5,2);
scatter(r2star_mean_D7, T1_entropy_D7); xlim([0 100]); ylim([0 4]);
subplot(1,5,3);
scatter(r2star_mean_WK8, T1_entropy_WK8); xlim([0 100]); ylim([0 4]);
subplot(1,5,4);
scatter(r2star_mean_M6, T1_entropy_M6); xlim([0 100]); ylim([0 4]);
subplot(1,5,5);
scatter(r2star_mean_Y1, T1_entropy_Y1); xlim([0 100]); ylim([0 4]);

%%
% Comparing between Pearson and Spearman
[rho, pval] = corr(FF_mean_D3', r2star_mean_D3');
disp(['Pearson: ', num2str(rho^2)])
[rho, pval] = corr(FF_mean_D7', r2star_mean_D7');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_WK8', r2star_mean_WK8');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_M6', r2star_mean_M6');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_Y1', r2star_mean_Y1');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_D3', r2star_mean_D3','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])
[rho, pval] = corr(FF_mean_D7', r2star_mean_D7','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_WK8', r2star_mean_WK8','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_M6', r2star_mean_M6','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_Y1', r2star_mean_Y1','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

% Comparing between Pearson and Spearman
[rho, pval] = corr(r2star_mean_D3', T1_entropy_D3');
disp(['Pearson: ', num2str(rho^2)])
[rho, pval] = corr(r2star_mean_D7', T1_entropy_D7');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(r2star_mean_WK8', T1_entropy_WK8');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(r2star_mean_M6', T1_entropy_M6');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(r2star_mean_Y1', T1_entropy_Y1');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(r2star_mean_D3', T1_entropy_D3','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])
[rho, pval] = corr(r2star_mean_D7', T1_entropy_D7','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(r2star_mean_WK8', T1_entropy_WK8','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(r2star_mean_M6', T1_entropy_M6','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(r2star_mean_Y1', T1_entropy_Y1','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

% Comparing between Pearson and Spearman
[rho, pval] = corr(FF_mean_D3', T1_entropy_D3');
disp(['Pearson: ', num2str(rho^2)])
[rho, pval] = corr(FF_mean_D7', T1_entropy_D7');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_WK8', T1_entropy_WK8');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_M6', T1_entropy_M6');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_Y1', T1_entropy_Y1');
disp(['Pearson: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_D3', T1_entropy_D3','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])
[rho, pval] = corr(FF_mean_D7', T1_entropy_D7','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_WK8', T1_entropy_WK8','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_M6', T1_entropy_M6','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])

[rho, pval] = corr(FF_mean_Y1', T1_entropy_Y1','Type', 'Spearman');
disp(['Spearman: ', num2str(rho^2)])
%% Patch-based
T1_entropy = [3.651852016	3.448816996	3.935725844	3.794528528	3.880217105	3.861450251	3.211344618	3.036148986	2.974907003	3.311395225	3.341826784	3.273105835	3.440181898	3.404094652	3.384812455	3.519694175	3.246831518	3.312118397	2.818186684	2.735426235	2.162682367	2.450287343	2.750176349	3.056133271	2.504481926	2.995368449	3.651354671	3.687402778	3.924803837	3.965372616	3.803432725	3.79231893	2.896518709	2.520474371	2.770114306	3.510384272	3.613739297	3.852393872	2.798535671	3.658152271	3.430240826	3.583252974	3.415306648	3.657609417	3.699940757	2.685868397	2.388130895];
FF_mean = [6.680217697	4.348963399	14.73341234	17.46544888	13.97115005	11.64147396	5.046227349	4.068600155	3.635968518	5.803833248	5.097112708	4.491020506	4.733400968	3.965855225	4.654350918	4.251838659	1.86837943	2.266013127	2.362896662	2.134324704	3.570942936	3.796613891	3.546075088	3.73864646	2.528607333	3.171628403	7.04473981	6.244034863	9.287746736	9.475740272	10.61550543	9.803464093	7.528116744	2.607501031	6.539356812	5.326499287	4.302585825	8.497243152	2.774316441	8.041952666	6.773236877	7.448128435	5.900249549	2.845845053	3.107234772	3.226080487	2.183118818];
r2star_mean = [59.01802018	56.16776161	57.67738441	55.47122306	58.08378679	54.30996568	43.69275301	42.35236454	44.33391202	43.99453097	38.33790478	36.71650236	43.31005528	45.47430531	43.29649064	43.66693605	25.20720977	30.30748141	32.58584156	29.47598455	34.82151862	34.64763235	36.98627966	38.5827214	36.98763193	38.38318543	65.47714897	63.68029026	51.72829038	49.13941779	52.93804956	52.76846518	48.29706328	41.37037676	38.51171912	46.98877093	39.12109698	83.86197734	48.33803444	58.57064515	52.69169455	57.07364352	51.38045216	49.49801604	49.58286391	34.5706765	31.29580923];

% 56 bins
T1_entropy = [4.067327805	3.882840336	4.325657935	4.155144066	4.361557207	4.308672552	3.720286289	3.518229941	3.479352626	3.783968498	3.804792586	3.74614022	3.902272355	3.887749512	3.85305384	3.982163365	3.722023543	3.735026384	3.282875375	3.11736031	2.642207619	2.91556615	3.24174551	3.54468374	3.001620772	3.447561834	4.074562039	4.124235906	4.428340001	4.438794889	4.227371336	4.225369096	3.406211106	2.934605666	3.236587253	3.967763429	4.064661733	4.323669497	3.09104576	4.048329939	3.886447358	4.080820888	3.931485188	4.132498311	4.108073673	3.103191832	2.822824098];

exclude_idx_ff = zeros(1, length(FF_mean)) > 0;
exclude_idx_r2star = zeros(1, length(r2star_mean)) > 0;
exclude_idx = zeros(1, length(FF_mean)) > 0;

% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean < 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean < 40;

exclude_idx = exclude_idx_ff | exclude_idx_r2star;


exclude_idx(4) = 1;
exclude_idx(33) = 1;
exclude_idx(35) = 1;
exclude_idx(38) = 1;


T1_entropy(exclude_idx) = [];
r2star_mean(exclude_idx) = [];
FF_mean(exclude_idx) = [];

%%
T1_entropy = [2.429752015	2.636990681	3.114035805	3.943383725	2.643215693	2.649792161	2.728884071	3.736064851	3.683529181	3.645889229	2.304801328	3.054016625	3.570247338	2.804041002	3.783647455	4.302152671	4.400388064	4.160026336];
LGE_entropy = [3.484474219	3.436485838	3.557588871	3.305645006	3.309975665	3.429908335	3.636838083	3.876929155	3.918368847	3.837609223	4.057909613	4.094886062	4.078860767	3.815231323	3.659306482	3.884978062	3.870250131	3.522038857];
FF_mean = [0.636639592	1.865653991	1.345933117	4.900145234	9.719854995	2.401783731	2.684916837	9.320714028	8.943914307	12.04769945	1.422804704	3.184270299	2.554192449	3.709142015	8.029844032	8.898270695	9.783539	7.193383625];
r2star_mean = [35.12006042	38.67715846	27.49120629	32.12196626	39.13354795	31.92301263	36.87221811	49.67470491	31.80848537	42.11305999	32.28621231	35.33440487	33.33091064	40.43188163	49.88945607	45.34242753	42.89065355	36.42944891];

exclude_idx_ff = zeros(1, length(FF_mean)) > 0;
exclude_idx_r2star = zeros(1, length(r2star_mean)) > 0;
exclude_idx = zeros(1, length(FF_mean)) > 0;

% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean < 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean < 40;

exclude_idx = exclude_idx_ff | exclude_idx_r2star;


exclude_idx(5) = 1;
% exclude_idx(33) = 1;
% exclude_idx(35) = 1;
% exclude_idx(38) = 1;


T1_entropy(exclude_idx) = [];
LGE_entropy(exclude_idx) = [];
r2star_mean(exclude_idx) = [];
FF_mean(exclude_idx) = [];

%% 8WK Canine Data
T1_entropy = [3.334888701	3.633349842	3.252616953	2.820713981	2.808963899	2.954330295	2.436478112	3.068902941	3.083472091	2.973587318	2.43185657	2.61725705	2.300896706	2.351880639	2.202139476	1.520252522	2.190281115	2.227194755	2.145280664	2.212208523	2.352493573	2.195785245	1.511939844	3.411922786	3.018525144	2.765394804	2.333993516	2.591779212	2.352695081	2.530792569	2.524285446	1.870466012	2.003061348	3.468712421	3.01493526	1.994904946	3.054123501	3.042149902	2.369648923	2.076351181	2.908243309	2.688268349	2.592259	2.472142089	3.49731982	3.385643131	3.111461402	2.782895422	2.059835641	2.098369511];
FF_mean = [4.492576483	3.307435299	3.123003832	1.05480846	2.769636455	2.095773323	2.743041283	3.794774022	6.084630189	1.723024416	1.532414044	0.771639167	1.722937103	2.92593365	1.704828937	1.898947005	1.542650764	2.09087656	1.988976437	2.232297457	2.174849461	1.708347872	1.341146303	4.131957504	3.397919674	4.200577665	2.939164328	2.056059951	2.389063329	1.900258027	3.596247706	3.589718092	2.185289109	2.443113224	1.660018833	1.986432261	5.46237013	7.917204323	3.232514865	2.549039822	3.843619205	2.380041753	2.365957623	1.279839709	1.419218552	1.297400776	1.382387416	1.374560184	1.130607038	2.090671709];
r2star_mean = [62.45249159	71.89573777	72.02493014	79.17155142	46.14558918	39.83673436	66.15532016	61.37462707	59.35326746	67.28555927	71.66426864	55.30203913	46.50273897	36.17613931	37.39686697	38.92127326	27.18300751	28.33590748	30.20857575	33.16216703	40.42829857	30.5762464	44.62631789	79.53856005	76.06846883	88.84204238	63.59306185	52.40397764	60.50705571	40.91851964	56.47629528	49.01852915	47.47078813	56.33423259	43.50322272	48.13340917	70.40702365	76.0941582	64.14153973	59.31534609	58.12144077	40.25755833	62.26956871	65.41812567	60.98430652	61.9548242	62.52918745	33.84623007	29.69572194	36.46360094];
T2_mean = [38.32951807	40.52340426	35.86995708	34.64568966	39.08712121	41.33208955	55.72615385	39.40905512	33.51617021	33.26974359	33.87515528	34.4	39.15021645	41.46394231	36.2622093	34.76931818	46.35106383	45.236	43.20506329	41.95740741	46.0384	45.43578947	43.56153846	34.65121951	33.9374613	33.43791209	44.57384615	47.62033898	43.11428571	41.38571429	31.26706231	29.20387931	29.21748252	32.62599119	33.3673913	34.71419355	34.98432432	35.38959538	31.05481481	35.9195122	46.45436893	45.18461538	42.12162162	41.47	41.52265625	35.0375	35.86	41.64545455	46.13888889	43.52352941];
T1_mean = [1140.457944	1100.853211	1167.597122	1207.061538	1277.236559	1255.859813	1280.676136	1282.28	1114.6125	1144.039216	1176.774648	1198.613333	1224.425	1216.192982	1142.556818	1148.22449	1302.988439	1318.900398	1266.583784	1289.377193	1326.609065	1290.785942	1285.676768	1120.598592	1191.538012	1191.098039	1273.705882	1268.003676	1289.383929	1290.973262	1180.381944	1186.048077	1194.835821	1141.984	1176.38806	1174.555556	1211.604167	1215.333333	1257.921348	1187.5	1302.783465	1269.767123	1255.298701	1297.652174	1111.724907	1173.780392	1161.247126	1283.895833	1205.509434	1232.166667];

dfp_treated_label = [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 0];
exclude_idx_ff = zeros(1, length(FF_mean)) > 0;
exclude_idx_r2star = zeros(1, length(r2star_mean)) > 0;
exclude_idx = zeros(1, length(FF_mean)) > 0;

% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean < 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean < 40;

find(abs(zscore(FF_mean)) > 2.5)


exclude_idx = exclude_idx_ff | exclude_idx_r2star;

% FF exclude
exclude_idx(9) = 1;
exclude_idx(38) = 1;
% T2 exclude
exclude_idx(7) = 1;
%exclude_idx(5) = 1;
% exclude_idx(33) = 1;
% exclude_idx(35) = 1;
% exclude_idx(38) = 1;


T1_entropy(exclude_idx) = [];
T2_mean(exclude_idx) = [];
r2star_mean(exclude_idx) = [];
FF_mean(exclude_idx) = [];
T1_mean(exclude_idx) = [];

dfp_treated_label(exclude_idx) = [];


%% 7D Canine Data
FF_mean = [2.47430805	2.499835083	3.025091529	2.446787906 	3.760534924	2.758749088	2.828815171	2.099418266	2.240354665	3.048626267	3.023899497	1.671038342	1.010292421	1.168845113	0.891801629	1.565045183	1.528730955	1.832874175	1.70702519	4.277599914	4.481804266	5.798237256	5.525132039	2.126277805	1.981871492	2.586881625	1.961878875	2.374735479	2.64488583	3.078856217	2.770525536	2.294488744	6.221840255	9.746408833	3.067650047	4.551956092	4.79050207	1.642884468	2.935729996	2.081172809	1.689920638	1.000671384	1.218576673];
T1_entropy = [2.63788915	3.054650281	2.917186999	2.971829967	2.356237177	2.384573794	2.564377255	2.62681932	2.720521496	2.817376357	2.756129149	2.660794032	1.812780356	2.33999801	2.48180922	2.216831401	2.06615327	2.728258962	3.148380393	2.101130333	2.321138506	2.311077429	2.622824877	2.548644828	2.650362246	2.309429539	2.329216472	2.256725229	2.672249711	2.609564657	2.725692286	2.534974497	2.608953802	2.639247016	2.082624959	2.15444532	2.274570463	2.31952486	2.590616313	2.218722245	2.803741181	2.193486127	2.454658207];
r2star_mean = [61.74432542	58.73064862	48.77744076	35.81472476	73.32975587	59.59090997	41.41595081	35.71633851	26.32563284	28.48988568	36.38591194	37.74302165	27.46176965	24.85076176	26.37341644	20.43318265	37.82723325	42.19971847	47.60603689	55.14409652	66.08579562	57.01028284	55.40416333	37.72068368	26.70926591	26.23144701	31.7430357	34.0342945	30.39362418	36.31798206	65.39128038	51.89356177	51.83889233	88.35375114	81.47960632	71.82153893	60.99445839	42.4653495	27.15209567	40.09563403	59.65357963	54.2157366	45.22720684];
T2_mean = [42.94737589	43.03723653	47.3519802	49.41113801	40.16659751	42.21809339	44.37766749	61.21478873	51.85658263	49.16393443	46.37339901	39.46022727	54.74806202	53.94740741	51.88899083	51.8640625	50.9	52.82627737	55.79186047	38.38739726	39.15519481	43.59384615	41.62215569	55.17164179	61.31451613	61.77727273	54.76813187	40.05133531	45.86153846	45.10509804	39.15097493	42.65229885	44.62807571	38.66763285	40.20980392	43.01617021	44.92909091	52.8	52.81705426	52.62105263	43.91780303	48.37070707	47.14486804];
T1_mean = [1408.936061	1405.992509	1369.189189	1342.064394	1405.940767	1378.578313	1371.115385	1318.931973	1373.677249	1372.492063	1330.722222	1277.04918	1349.093333	1330.827692	1362.30566	1340	1370.086849	1352.56746	1364.960894	1414.732323	1399.0181	1395.724444	1330.491892	1322.685786	1463.007712	1352.545752	1287.022857	1414.623711	1377.167568	1368.647727	1422.34104	1398.36019	1371.088889	1406.315625	1373.012605	1384.008511	1385.928889	1410.402542	1385.247525	1303.191111	1432.39576	1295.470356	1440.540741];

dfp_treated_label = [1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 1 1 1 0 0 0];
exclude_idx_ff = zeros(1, length(FF_mean)) > 0;
exclude_idx_r2star = zeros(1, length(r2star_mean)) > 0;
exclude_idx = zeros(1, length(FF_mean)) > 0;

% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean < 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean < 4;
% exclude_idx_r2star = r2star_mean >= 40;
% 
% exclude_idx_ff = FF_mean >= 4;
% exclude_idx_r2star = r2star_mean < 40;

find(abs(zscore(FF_mean)) > 2.5)
find(abs(zscore(T2_mean)) > 2.5)
find(abs(zscore(r2star_mean)) > 2.5)

exclude_idx = exclude_idx_ff | exclude_idx_r2star;

% % FF exclude
exclude_idx(34) = 1;
% exclude_idx(38) = 1;
% % T2 exclude
% exclude_idx(7) = 1;

T1_entropy(exclude_idx) = [];
T2_mean(exclude_idx) = [];
r2star_mean(exclude_idx) = [];
FF_mean(exclude_idx) = [];
T1_mean(exclude_idx) = [];

dfp_treated_label(exclude_idx) = [];

%% Patient Data Chronic (FU)
FF_mean = [2.383950672	2.467263836	1.394702676	0	4.900145234	0	0	4.302630607	0	7.556507468	7.622152845	9.317186258	0	1.422804704	3.184270299	4.452997551	0	3.709142015	8.029844032	8.898270695	9.783539	7.193383625	0	0	0	0	6.279710903	0	3.37815015	2.584472721	2.646230912	4.516129712	4.476916483	0	3.2279974	4.201361155	3.780545521	5.316875565	0	1.754163536	2.736202194	3.665498541	5.046427892	0	3.537005252	2.27333252	4.993525317	0	2.300686866	3.089349171	3.284265579	0	13.69215083	13.8069145	6.691615253	5.608294136	0	0	3.657640299	3.69628845	3.882659004	0	3.095870085	2.05227734	4.134227396	2.863316787	2.059965275	0	4.061203788	3.609909058	3.180440303	3.793106931	4.28592579	0	1.295606768	2.485231455	3.648186511	0	5.704687697	9.327676505	0	2.428533733	1.63289635	8.736793775	3.585212699	0	3.246779513	2.133682232	2.95613735	3.718429487	8.497683523	0	2.842620022	3.361813376	3.333753284	0	5.753012301	2.771570607	5.471324632	0	0	3.542909228	2.739717311	3.878006489	1.841700939	2.628714861	0	3.071795545	3.463247346	6.565732903	4.829433897	0	3.906279977	7.660681212	11.39270963	5.031301762	0	5.1427	3.6599	3.1744	0	0	0	2.818740422	8.886113212	4.320839329];
r2star_mean = [29.70203919	42.10079197	28.05368241	0	32.12196626	0	0	35.02456224	0	30.36814707	37.75915368	32.28621231	0	32.28621231	35.33440487	37.75225299	0	40.43188163	49.88945607	45.34242753	42.89065355	36.42944891	0	0	0	0	37.07067409	0	31.72475657	27.32497774	26.85169666	30.59617093	29.68537405	0	32.26571137	40.85625422	30.47017886	30.70992232	0	32.78491761	31.67400119	35.65615267	31.48504623	0	39.1911374	46.88029439	27.68241758	0	26.23218348	27.38167066	19.57725515	0	59.56242891	61.01370781	43.01167805	35.04743	0	0	33.98527181	32.35608175	30.90943033	0	22.64876341	24.62922009	34.05569397	41.13284827	27.43110969	0	27.8068147	29.15751212	36.26492798	28.16704784	20.80404566	0	25.09387059	30.07456821	29.4257035	0	36.01009046	30.65949984	0	29.11511999	30.19876066	27.91161094	33.1567717	0	33.76642109	37.40002903	32.54261359	33.80099912	51.43499976	0	36.10759374	43.41479081	53.23844048	0	31.29172296	32.06864884	58.2329138	0	0	32.47306036	31.13590246	29.14178722	27.13840949	34.84719507	0	42.23220576	38.76032088	52.90942644	47.4532168	0	35.80319799	35.6897084	30.54750753	28.39585258	0	45.2729	31.528	30.0583	0	0	0	34.25875144	42.16768779	50.54663004];
T2_mean = [54.92619048	52.56984127	51.06666667	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	47.43108108	51.63298969	52.8741573	58.25777778	0	0	0	0	0	0	0	50.92291667	53.33205128	60.27362637	56.2244186	0	0	0	0	0	0	0	0	0	0	55.855	50.92745098	0	0	0	0	0	0	0	0	52.14	53.99186047	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	60.80973451	55.91666667	0	53.42857143	51.27066667	52.88953488	0	0	0	0	0	0	0	0	0	0	0	0	50.80722892	49.49298246	47.12941176	46.02264151	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	55.94761905	0	59.65964912	57.7078125	0	0	48.48243243	48.51888889	0];
% T1_entropy = [2.429752015	2.636990681	3.114035805	0	3.943383725	2.643215693	2.649792161	2.728884071	0	3.736064851	3.683529181	3.645889229	0	2.304801328	3.054016625	3.570247338	0	2.804041002	3.783647455	4.302152671	4.400388064	4.160026336	0	1.775460037	3.300461149	4.200587964	3.953806891	0	3.879933747	3.65507922	3.946096178	3.961590193	3.891226627	0	2.894417743	3.045173184	4.070921522	3.875769684	0	2.499277666	2.877797371	3.569740133	3.606724732	0	3.287192004	2.98435543	2.810747009	0	3.219687962	3.396810835	2.867022374	0	4.225867902	3.906872895	3.160988692	3.483376337	3.212263582	0	3.843144549	3.129046433	3.51227034	0	3.313882479	3.238308429	2.277156468	3.021837646	2.792292913	0	2.717042709	2.484860819	3.056226996	3.44932881	3.287245871	0	2.857631299	2.61646768	3.661992046	0	4.433099813	4.309643384	0	2.728605569	4.068512479	3.471500391	2.514303311	0	3.460487046	3.434332037	3.902580033	3.742682799	3.599850838	0	3.517218653	2.922130246	3.695420669	0	3.273056856	3.441486286	2.92207216	2.760954001	0	2.725451807	2.901942163	2.84868092	3.167195455	2.717298487	0	3.280320937	3.254713026	4.428143261	4.627304066	0	3.298471013	3.083973084	4.240850162	3.687789582	0	3.040627876	3.090631982	3.648648614	3.064438741	3.036433793	0	2.402886463	4.0953314	4.26387305];

FF_mean_remote = [];
% unweighted 20 bins
T1_entropy = [1.840519968	2.044500406	2.391894698	0	3.141645311	2.06568997	1.837911029	2.092878689	0	2.663277389	2.369668375	2.544123201	0	1.594586777	1.95635257	2.602200942	0	2.201849291	2.673044546	3.219911346	3.232823069	3.090058596	0	1.330836909	2.309000088	3.018981621	2.868079502	0	2.614037651	2.38463941	2.573710717	2.865969723	2.84990852	0	2.384891686	2.197824294	3.214189428	3.215378773	0	1.907930908	1.964487289	2.678086676	3.030059888	0	2.757540158	2.426878989	2.373522196	0	2.462012974	2.393206587	1.914867747	0	3.153923078	3.013226621	2.504719113	2.761475256	2.527898841	0	2.74241881	2.115731984	2.745122422	0	2.663469297	2.709639679	1.565451349	2.394547083	1.875353575	0	2.231894318	2.005376628	2.405768384	2.72144434	2.778244656	0	2.179827804	1.863926288	2.710053091	0	3.235400277	3.169889411	0	2.060474996	3.315394316	2.651004293	2.072437376	0	2.674641232	2.594266344	2.994417939	2.981516524	2.883494736	0	2.691746242	1.995074597	2.938632816	0	2.410226222	2.761034364	2.143052662	1.775790553	0	2.07665824	2.136681447	2.385394337	2.417588326	2.018219752	0	2.486782652	2.475230495	3.477153467	3.545392479	0	2.726716398	2.338737126	3.16693434	2.799942068	0	2.319762911	1.927745383	2.856223789	2.307880575	2.391333507	0	1.901608358	2.956048732	3.051331835];


% 2024 ver
T1_entropy = [1.840519968	2.044500406	2.391894698	3.141645311	1.837911029	2.092878689	2.663277389	2.369668375	2.544123201	1.594586777	1.95635257	2.201849291	2.673044546	3.219911346	3.232823069	3.090058596	2.614037651	2.38463941	2.573710717	2.865969723	2.84990852	2.384891686	2.197824294	3.214189428	3.215378773	1.907930908	1.964487289	2.678086676	3.030059888	2.757540158	2.426878989	2.373522196	2.462012974	2.393206587	1.914867747	3.153923078	3.013226621	2.504719113	2.761475256	2.527898841	2.74241881	2.115731984	2.745122422	2.663469297	2.709639679	1.565451349	2.394547083	1.875353575	2.231894318	2.005376628	2.405768384	2.72144434	2.778244656	2.179827804	1.863926288	2.710053091	3.235400277	3.169889411	2.060474996	3.315394316	2.651004293	2.072437376	2.674641232	2.594266344	2.994417939	2.981516524	2.883494736	2.691746242	1.995074597	2.938632816	2.410226222	2.761034364	2.143052662	1.775790553	2.07665824	2.136681447	2.385394337	2.417588326	2.018219752	2.486782652	2.475230495	3.477153467	3.545392479	2.726716398	2.338737126	3.16693434	2.799942068	2.319762911	1.927745383	2.307880575	1.901608358	2.956048732	3.051331835]
FF_mean = [2.383950672	2.467263836	1.394702676	4.900145234	2.401783731	2.684916837	7.556507468	7.622152845	9.317186258	1.422804704	3.184270299	3.709142015	8.029844032	8.898270695	9.783539	7.193383625	3.37815015	2.584472721	2.646230912	2.848763098	4.476916483	3.2279974	3.015631183	2.53382371	3.018230521	1.754163536	2.736202194	3.665498541	4.18963012	4.993525317	3.537005252	1.652918965	2.300686866	2.830984548	2.947852353	13.69215083	13.8069145	6.691615253	5.608294136	1.190721127	3.133765401	3.107209002	3.657640299	3.462426854	2.406376688	2.812107079	2.059965275	2.05227734	4.061203788	4.28592579	3.793106931	2.307066338	3.609909058	1.295606768	2.485231455	1.667435477	5.704687697	9.327676505	1.63289635	2.428533733	8.736793775	2.126359335	3.468795802	2.140867527	3.044019808	3.089405033	5.30876759	2.842620022	3.361813376	3.333753284	5.753012301	2.771570607	5.471324632	8.849562091	3.542909228	2.739717311	3.878006489	1.841700939	2.628714861	3.071795545	3.463247346	4.157157477	3.449259208	2.655757328	3.02652666	1.484825778	2.695886274	5.142656039	3.65985824	3.285111441	2.793964319	8.886113212	4.320839329];
r2star_mean = [29.70203919	42.10079197	28.05368241	32.12196626	32.37167921	35.02456224	45.12120348	37.75915368	30.36814707	32.28621231	35.33440487	40.43188163	49.88945607	45.34242753	42.89065355	36.42944891	31.72475657	27.32497774	26.85169666	26.01677216	29.68537405	32.26571137	32.21317256	25.66474312	27.66165615	32.78491761	31.67400119	35.65615267	30.62497633	39.1911374	46.88029439	18.4349467	26.23218348	28.87341005	18.17688628	59.56242891	61.01370781	43.01167805	35.04743	12.61836195	31.10192925	31.36519193	33.98527181	34.63825134	35.94166968	23.49924886	27.43110969	24.62922009	27.8068147	20.80404566	28.16704784	35.31295339	29.15751212	25.09387059	30.07456821	30.34821521	36.01009046	30.65949984	30.19876066	29.11511999	27.91161094	28.0487211	41.55353266	41.24845959	32.26876168	29.67056692	48.17018588	36.10759374	43.41479081	53.23844048	31.29172296	32.06864884	58.2329138	53.83615495	32.47306036	31.13590246	29.14178722	27.13840949	34.84719507	42.23220576	38.76032088	49.38486949	40.06802955	35.6858058	32.15165744	20.80210003	23.89984222	45.27293403	31.52799428	29.95047494	34.21419381	42.16768779	50.54663004];


% 2024 20 bins, 750-1750
T1_entropy = [2.282052907	2.50214416	2.698840463	3.565996152	2.107209217	2.517405811	2.891803587	2.687557636	2.779089414	2.071836955	2.434981282	2.660594407	3.055451697	3.257695131	3.168508258	3.148547541	3.05574655	2.763999462	3.061444474	3.076615703	3.214258145	2.726572407	2.689472453	3.4038486	3.493214622	2.322916317	2.447544659	3.092998395	3.515500819	3.176779974	2.846919241	2.814137475	2.886970222	2.8535377	2.321656703	3.525213052	3.47485847	2.974662354	3.092947998	2.904581205	3.063985766	2.584292241	3.180212629	3.08652287	3.116956117	2.001185038	2.839105664	2.369846043	2.558038439	2.293381136	2.812782274	3.11698756	3.1791488	2.583842324	2.336757553	3.139869217	3.320123156	3.095189565	2.534839076	3.738229053	2.938008139	2.481636527	3.060926669	3.027128558	3.343563305	3.241790095	3.080282958	3.219814384	2.50558227	3.289952371	2.829228647	3.172438202	2.674857418	2.115145676	2.497252702	2.565987245	2.810090447	2.865854169	2.451110586	2.9032683	3.029325444	3.695917759	3.649557743	3.049077484	2.722554531	3.186806579	3.137421484	2.685367493	2.499591983	2.756585867	2.283622576	3.135282623	3.052215685];
FF_mean = [2.383950672	2.467263836	1.394702676	4.900145234	2.401783731	2.684916837	7.556507468	7.622152845	9.317186258	1.422804704	3.184270299	3.709142015	8.029844032	8.898270695	9.783539	7.193383625	3.37815015	2.584472721	2.646230912	2.848763098	4.476916483	3.2279974	3.015631183	2.53382371	3.018230521	1.754163536	2.736202194	3.665498541	4.18963012	4.993525317	3.537005252	1.652918965	2.300686866	2.830984548	2.947852353	13.69215083	13.8069145	6.691615253	5.608294136	1.190721127	3.133765401	3.107209002	3.657640299	3.462426854	2.406376688	2.812107079	2.059965275	2.05227734	4.061203788	4.28592579	3.793106931	2.307066338	3.609909058	1.295606768	2.485231455	1.667435477	5.704687697	9.327676505	1.63289635	2.428533733	8.736793775	2.126359335	3.468795802	2.140867527	3.044019808	3.089405033	5.30876759	2.842620022	3.361813376	3.333753284	5.753012301	2.771570607	5.471324632	8.849562091	3.542909228	2.739717311	3.878006489	1.841700939	2.628714861	3.071795545	3.463247346	4.157157477	3.449259208	2.655757328	3.02652666	1.484825778	2.695886274	5.142656039	3.65985824	3.285111441	2.793964319	8.886113212	4.320839329];
r2star_mean = [29.70203919	42.10079197	28.05368241	32.12196626	32.37167921	35.02456224	45.12120348	37.75915368	30.36814707	32.28621231	35.33440487	40.43188163	49.88945607	45.34242753	42.89065355	36.42944891	31.72475657	27.32497774	26.85169666	26.01677216	29.68537405	32.26571137	32.21317256	25.66474312	27.66165615	32.78491761	31.67400119	35.65615267	30.62497633	39.1911374	46.88029439	18.4349467	26.23218348	28.87341005	18.17688628	59.56242891	61.01370781	43.01167805	35.04743	12.61836195	31.10192925	31.36519193	33.98527181	34.63825134	35.94166968	23.49924886	27.43110969	24.62922009	27.8068147	20.80404566	28.16704784	35.31295339	29.15751212	25.09387059	30.07456821	30.34821521	36.01009046	30.65949984	30.19876066	29.11511999	27.91161094	28.0487211	41.55353266	41.24845959	32.26876168	29.67056692	48.17018588	36.10759374	43.41479081	53.23844048	31.29172296	32.06864884	58.2329138	53.83615495	32.47306036	31.13590246	29.14178722	27.13840949	34.84719507	42.23220576	38.76032088	49.38486949	40.06802955	35.6858058	32.15165744	20.80210003	23.89984222	45.27293403	31.52799428	29.95047494	34.21419381	42.16768779	50.54663004];

% 2024 20 bins, 750-1750 Remote
% T1_entropy = [0.998000884	1.987516816	1.575482631	1.75748399	2.33790657	2.041946032	1.764694686	1.493213364	1.591672779	2.00869497	1.338268928	2.077323802	1.748999223	1.789929075	1.389674919	1.456564762	1.414164757	1.548427776	1.78149633	1.75748399	2.00869497	1.707113464	1.298720786	1.890716087	1.875131049	1.845455994	2.138460067	2.525068281	1.918295834	0.543564443	0.591672779	1.64939747	1.779423832	2.25690899	1.806853362	1.156227284	1.549397853	1.27694356	1.123087583	2.656564762	1.388259036	1.429473298	1.851226816	1.761446013	1.435371391	1.489758698	2.069893616	1.543564443	2.23829757	1.377890332	1.377963039	2.221251836	2.970840013	1.521928095	1.457717469	1.982754917	1.93129528	1.842478563	1.537984108	2.402633061	1.121640762	2.105587262	1.970124741	1.210810026	2.214955585	1.514302951	3.00869497	2.074053416	1.287054028	1.613714972	0.948078244	1.188376372	1.460484681	1.794713756	1.165784052	1.520426041	0.856995718	0.721928095	1.495628243	1.578450254	1.469965062	1.098486838	1.549526779	3.039699362	2.837869421	2.256866543	2.440381155	1.280320493	2.280639062	1.607455099	1.991827343	1.15018548	2.234196947];


exclude_idx_ff = zeros(1, length(FF_mean)) > 0;
exclude_idx_r2star = zeros(1, length(r2star_mean)) > 0;
exclude_idx = zeros(1, length(FF_mean)) > 0;

exclude_idx_ff = (FF_mean == 0);
exclude_idx_t2 = (T2_mean == 0);
exclude_idx = exclude_idx_ff | exclude_idx_r2star;
% exclude_idx = exclude_idx_ff | exclude_idx_r2star | exclude_idx_t2;


% % FF exclude
% exclude_idx(37) = 1;
% exclude_idx(38) = 1;
% exclude_idx(85) = 1;
% 
% % % R2star exclude
% exclude_idx(73) = 1;

% FF exclude
exclude_idx(74) = 1;

T1_entropy(exclude_idx) = [];
T2_mean(exclude_idx) = [];
r2star_mean(exclude_idx) = [];
FF_mean(exclude_idx) = [];

find(abs(zscore(FF_mean)) > 2.5)
find(abs(zscore(T2_mean)) > 2.5)
find(abs(zscore(r2star_mean)) > 2.5)

% % % FF exclude
% exclude_idx(35) = 1;
% exclude_idx(36) = 1;
% exclude_idx(81) = 1;
% 
% % % R2star exclude
% exclude_idx(69) = 1;
%% Main Analysis Here
color_cell1 = {[254,240,217]/255, [253,204,138]/255, [252,141,89]/255, [227,74,51]/255, [179,0,0]/255};
color_cell2 = {[241, 238, 246]/255, [189, 201, 225]/255, [116, 169, 207]/255, [43, 140, 190]/255, [4, 90, 141]/255};


addpath('../function/BlandAltman/');
% Heart muscle territories per patient
territories = {''};
nterritories = length(territories);

% Patient states during measurement
states = {'chronic'};

% figure();
% plot(T1_entropy, FF_mean, 'o');
% 
% figure(); 
% plot(T1_entropy, r2star_mean, 'o');


labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise
data1 = cat(3, T1_entropy(:));
data2 = cat(3, FF_mean(:));

data1 = cat(3, FF_mean(:));
data2 = cat(3, T1_entropy(:));

% BA plot paramters
tit = 'T1 Entropy vs Fat Fraction'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
% label = {'T1-Entropy','FF','%'}; % Names of data sets
label = {'FF','T1-entropy'}; % Names of data sets
corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [0 20 0 5];
%axesLimits = [2 6 0 20];
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);

%%
labels = repmat(1, [1, length(LGE_entropy)]);
% Baseline data with noise
data1 = cat(3, LGE_entropy(:));
data2 = cat(3, FF_mean(:));

data1 = cat(3, FF_mean(:));
data2 = cat(3, LGE_entropy(:));

% BA plot paramters
tit = 'LGE Entropy vs Fat Fraction'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'FF','LGE-entropy'}; % Names of data sets
corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end

% axesLimits = [2 6 0 20];
axesLimits = [0 20 2 6];
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);

%% 
labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise

data1 = cat(3, T2_mean(:));
data2 = cat(3, T1_entropy(:));

% data1 = cat(3, T1_entropy(:));
% data2 = cat(3, T2_mean(:));
% BA plot paramtersx
tit = 'T1 Entropy vs T2'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'T2-mean', 'T1-entropy'}; % Names of data sets

corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [0 60 0 5];

% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);


% X = [ones(length(T2_mean),1) T2_mean(:)];
% b = X\T1_entropy(:);
% yCalc2 = X*b;
% figure();
% plot(T2_mean(:),yCalc2,'--')
% legend('Data','Slope','Slope & Intercept','Location','best');
% xlim([0 60]); ylim([1 6]);
%%
labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise

data1 = cat(3, T2_mean(:));
data2 = cat(3, LGE_entropy(:));

% BA plot paramters
tit = 'LGE Entropy vs T2'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'T2-mean', 'LGE-entropy'}; % Names of data sets

corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [0 60 1 6];

% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);

%%
labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise
data1 = cat(3, T1_entropy(:));
data2 = cat(3, r2star_mean(:));

data1 = cat(3, r2star_mean(:));
data2 = cat(3, T1_entropy(:));

% BA plot paramters
tit = 'T1 Entropy vs R2star'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'T1-Entropy','R2star','s-1'}; % Names of data sets
label = {'R2star','T1-entropy','s-1'}; % Names of data sets

corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [2 6 0 100];
axesLimits = [0 100 0 5];
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);

%%
labels = repmat(1, [1, length(LGE_entropy)]);
% Baseline data with noise
data1 = cat(3, LGE_entropy(:));
data2 = cat(3, r2star_mean(:));

data1 = cat(3, r2star_mean(:));
data2 = cat(3, LGE_entropy(:));
% BA plot paramters
tit = 'LGE Entropy vs R2star'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'LGE-Entropy','R2star','s-1'}; % Names of data sets
label = {'R2star','LGE-entropy','s-1'}; % Names of data sets
corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
%axesLimits = [2 6 0 100];
axesLimits = [0 100 2 6]
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);

%% 
labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise
data1 = cat(3, T1_entropy(:));
data2 = cat(3, LGE_entropy(:));

% BA plot paramters
tit = 'T1 Entropy vs LGE Entropy'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'T1-Entropy','LGE-Entropy','Unitless'}; % Names of data sets
corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [2 6 2 6];
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);

%% FF vs R2star
territories = {''};
nterritories = length(territories);

% Patient states during measurement
states = {'chronic'};

% figure();
% plot(T1_entropy, FF_mean, 'o');
% 
% figure(); 
% plot(T1_entropy, r2star_mean, 'o');


labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise

data1 = cat(3, FF_mean(:));
data2 = cat(3, r2star_mean(:));

% BA plot paramters
tit = 'Fat Fraction vs R2star'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
% label = {'T1-Entropy','FF','%'}; % Names of data sets
label = {'FF','R2star'}; % Names of data sets
corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [0 20 0 100];
%axesLimits = [2 6 0 20];
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);



%% Multiple linear regression
T1_entropy = [4.155854443	4.583806632	4.315754456	4.088586506	3.87494749	3.922804212	3.857169446	4.002481407	3.546814105	2.934714329	3.64359082	3.492544805	3.09303178	2.969015731	3.150505069	2.612399916	2.707342443	3.348294038	3.252863381	3.910689865	3.940530648	3.545899774	3.818083136	3.192966838	3.85244705	4.440089136	4.230228959	4.087134786	3.73376797	3.966280504	3.657703882	3.358182122	3.329851105	3.16492367	4.015186999	3.52200691	3.982795171	4.506174388	3.909139297	4.387479894	4.034480418	3.802665011	3.298068512	3.96961873	3.847832014	3.432847581	2.754441846	2.521928095	3.431623566];
FF_mean = [15.60447728	14.78351024	12.17616673	8.138109019	6.199221444	6.298566453	6.349978604	3.980585046	4.247593918	4.852949747	4.657240867	5.177199829	1.631045615	2.728173187	2.586949272	2.267199355	1.965339977	3.132784497	3.067722853	3.436115497	3.447189287	4.457039614	3.453607224	1.485206799	10.56805944	11.57662087	12.4761005	6.204056188	6.20985808	7.109428801	8.894293271	5.763136511	8.114717589	4.279872056	2.760749916	3.46983488	8.439058352	12.71780664	3.220006784	9.364701114	7.498762478	3.849234679	3.67828082	2.795359749	3.624650895	2.636651685	1.430597131	3.262081827	4.778726584];
r2star_mean = [62.97160686	61.44405532	54.40868886	48.09030404	49.84719683	44.13125753	48.86915895	33.58955265	38.02172821	41.81526572	39.76389763	44.32598027	40.20305723	36.12753645	33.61147748	36.66169398	25.66525328	35.12353681	39.35319758	37.00863445	36.9487465	45.06678416	37.977241	33.36696338	55.72579252	50.11184238	56.23618837	51.96202513	45.32157871	53.42367437	46.13076239	38.3749292	43.1041654	36.08635756	40.34869025	39.22262539	104.1659527	89.32698057	68.73375711	66.9378156	56.83786406	48.12828032	35.04357941	50.1362844	47.87491294	43.30856064	32.83326505	32.14249061	35.03343475];
LGE_entropy = [3.656983712	3.941199266	4.089784859	3.881284742	3.561233334	3.483935743	3.664229119	3.684560896	3.712323528	2.872692183	3.591349559	3.79807022	3.812485947	3.905203054	3.88953028	3.784297394	3.661828484	3.497389336	3.27292933	3.371202524	3.729770675	3.308398669	2.969344194	3.185402274	3.437481925	3.390369363	3.518518126	3.287219955	3.629044281	3.559846451	3.491380001	3.699868659	3.950789424	3.948536049	3.737666023	3.88516019	3.316607955	3.296621536	3.67518154	3.009576965	3.755538804	3.767331131	3.667713115	3.872188177	3.872188177	3.802597693	3.633783409	3.322179346	3.559900002];
%exclude_idx = [8 20 21 23 35 39 42 44 45]; 
% exclude high T1 entropy but low FF
%exclude_idx = [1 2 3 25 26 27 37 38 40];

exclude_idx = [37 38 39];
 T1_entropy(exclude_idx) = [];
 LGE_entropy(exclude_idx) = [];
 r2star_mean(exclude_idx) = [];
 FF_mean(exclude_idx) = [];
%%
y = T1_entropy';
X = [ones(size(FF_mean')) FF_mean' r2star_mean'];
[b,bint,r,rint,stats] = regress(y,X);
contain0 = (rint(:,1)<0 & rint(:,2)>0);
idx = find(contain0==false);

% stats that contains the R2 statistic, the F-statistic and its p-value, and an estimate of the error variance
figure();
scatter3(FF_mean', r2star_mean', T1_entropy')
hold on
scatter3(FF_mean(idx),r2star_mean(idx), T1_entropy(idx), 'b','filled')

x1fit = min(FF_mean):1:max(FF_mean);
x2fit = min(r2star_mean):10:max(r2star_mean);
[X1FIT,X2FIT] = meshgrid(x1fit,x2fit);
YFIT = b(1) + b(2)*X1FIT + b(3)*X2FIT;
mesh(X1FIT,X2FIT,YFIT)
xlabel('FF')
ylabel('R2star')
zlabel('T1')
view(50,10)
hold off;

%%
color_cell1 = {[254,240,217]/255, [253,204,138]/255, [252,141,89]/255, [227,74,51]/255, [179,0,0]/255};
color_cell2 = {[241, 238, 246]/255, [189, 201, 225]/255, [116, 169, 207]/255, [43, 140, 190]/255, [4, 90, 141]/255};


addpath('../function/BlandAltman/');
% Heart muscle territories per patient
territories = {''};
nterritories = length(territories);

% Patient states during measurement
states = {'chronic'};

figure();
plot(T1_entropy, r, 'o');

labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise
data1 = cat(3, T1_entropy(:));
%data1 = cat(3, FF_mean(:));
%data1 = cat(3, r2star_mean(:));

data2 = cat(3, r(:));

% BA plot paramters
tit = 'Residual vs T1-entropy'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'Residual','T1-entropy','Unitless'}; % Names of data sets
label = {'T1-entropy','Residual','Unitless'}; % Names of data sets
%label = {'FF','Residual','Unitless'}; % Names of data sets
%label = {'r2star','Residual','Unitless'}; % Names of data sets

corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [2 6 -1 1];
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);


r_init = r;

%%
y = LGE_entropy';
X = [ones(size(FF_mean')) FF_mean' r2star_mean'];
[b,bint,r,rint,stats] = regress(y,X);
% stats that contains the R2 statistic, the F-statistic and its p-value, and an estimate of the error variance
figure();
scatter3(FF_mean', r2star_mean', LGE_entropy','filled')
hold on
x1fit = min(FF_mean):1:max(FF_mean);
x2fit = min(r2star_mean):10:max(r2star_mean);
[X1FIT,X2FIT] = meshgrid(x1fit,x2fit);
YFIT = b(1) + b(2)*X1FIT + b(3)*X2FIT;
mesh(X1FIT,X2FIT,YFIT)
xlabel('FF')
ylabel('R2star')
zlabel('T1')
view(50,10)
hold off

%% For illustration

FF_mean_illu = zeros(1, length(FF_mean));
FF_mean_illu_label = find(FF_mean >= 4);
FF_mean_illu_label_n = find(FF_mean < 4);

FF_mean_illu_p = FF_mean(FF_mean >= 4) + 0.5;
FF_mean_illu_n = FF_mean(FF_mean < 4);

FF_mean_illu(FF_mean_illu_label) = FF_mean_illu_p;
FF_mean_illu(FF_mean_illu_label_n) = FF_mean_illu_n;

r2star_mean_illu = zeros(1, length(r2star_mean));
r2star_mean_illu_label = find(r2star_mean >= 35);
r2star_mean_illu_label_n = find(r2star_mean < 35);

r2star_mean_illu_p = r2star_mean(r2star_mean >= 35) + 2;
r2star_mean_illu_n = r2star_mean(r2star_mean < 35);

r2star_mean_illu(r2star_mean_illu_label) = r2star_mean_illu_p;
r2star_mean_illu(r2star_mean_illu_label_n) = r2star_mean_illu_n;

figure();
scatter(FF_mean_illu, r2star_mean_illu, 'filled');
xlim([0 20]); ylim([0 100]);
hold on;
xline(4.25);
yline(36);
%axis off;

%% For publication
color_cell_exvivo = {[241, 238, 246]/255, [189, 201, 225]/255, [116, 169, 207]/255, [43, 140, 190]/255, [4, 90, 141]/255};
color_cell_invivo = {[242,240,247]/255, [203,201,226]/255, [158,154,200]/255, [117,107,177]/255, [84,39,143]/255}; % Purple
color_cell_avg16 = {[254,240,217]/255, [253,204,138]/255, [252,141,89]/255, [227,74,51]/255, [179,0,0]/255};

FF_mean_illu = zeros(1, length(FF_mean));
FF_mean_illu_label_pp = find(FF_mean >= 4 & r2star_mean >= 35);
FF_mean_illu_label_np = find(FF_mean < 4 & r2star_mean >= 35);
FF_mean_illu_label_nn = find(FF_mean < 4 & r2star_mean < 35);

FF_mean_illu_pp = FF_mean(FF_mean >= 4 & r2star_mean >= 35) + 0.6;
FF_mean_illu_np = FF_mean(FF_mean < 4 & r2star_mean >= 35);
FF_mean_illu_nn = FF_mean(FF_mean < 4 & r2star_mean < 35);

r2star_mean_illu = zeros(1, length(r2star_mean));
r2star_mean_illu_label_pp = find(FF_mean >= 4 & r2star_mean >= 35);
r2star_mean_illu_label_np = find(FF_mean < 4 & r2star_mean >= 35);
r2star_mean_illu_label_nn = find(FF_mean < 4 & r2star_mean < 35);

r2star_mean_illu_pp = r2star_mean(FF_mean >= 4 & r2star_mean >= 35) + 3;
r2star_mean_illu_np = r2star_mean(FF_mean < 4 & r2star_mean >= 35) + 3;
r2star_mean_illu_nn = r2star_mean(FF_mean < 4 & r2star_mean < 35);

FF_mean_illu(FF_mean_illu_label_pp) = FF_mean_illu_pp;
FF_mean_illu(FF_mean_illu_label_np) = FF_mean_illu_np;
FF_mean_illu(FF_mean_illu_label_nn) = FF_mean_illu_nn;

r2star_mean_illu(r2star_mean_illu_label_pp) = r2star_mean_illu_pp;
r2star_mean_illu(r2star_mean_illu_label_np) = r2star_mean_illu_np;
r2star_mean_illu(r2star_mean_illu_label_nn) = r2star_mean_illu_nn;

figure();
scatter(FF_mean_illu, r2star_mean_illu, 'filled');
xlim([0 20]); ylim([0 100]);
hold on;
xline(4.25);
yline(36);

T1_entropy_illu_pp = T1_entropy(FF_mean >= 4 & r2star_mean >= 35);
T1_entropy_illu_np = T1_entropy(FF_mean < 4 & r2star_mean >= 35);
T1_entropy_illu_nn = T1_entropy(FF_mean < 4 & r2star_mean < 35);

T2_mean_illu_pp = T2_mean(FF_mean >= 4 & r2star_mean >= 35);
T2_mean_illu_np = T2_mean(FF_mean < 4 & r2star_mean >= 35);
T2_mean_illu_nn = T2_mean(FF_mean < 4 & r2star_mean < 35);

FF_mean_illu_pp_v2 = FF_mean(FF_mean >= 4 & r2star_mean >= 35);
FF_mean_illu_np_v2 = FF_mean(FF_mean < 4 & r2star_mean >= 35);
FF_mean_illu_nn_v2 = FF_mean(FF_mean < 4 & r2star_mean < 35);

r2star_mean_illu_pp_v2 = r2star_mean(FF_mean >= 4 & r2star_mean >= 35);
r2star_mean_illu_np_v2 = r2star_mean(FF_mean < 4 & r2star_mean >= 35);
r2star_mean_illu_nn_v2 = r2star_mean(FF_mean < 4 & r2star_mean < 35);
%% For publication
plotHandles = zeros(4,3);
% figure();
figure('Position', [0 100 600 350]);
plotHandles(:,1) = scatter(FF_mean_illu_pp, r2star_mean_illu_pp, 64, 'filled', 'Color', color_cell_exvivo{1});
hold on;
plotHandles(:,2) = scatter(FF_mean_illu_np, r2star_mean_illu_np, 64, 'filled', 'Color', color_cell_avg16{1});
plotHandles(:,3) = scatter(FF_mean_illu_nn, r2star_mean_illu_nn, 64, 'filled', 'Color', color_cell_invivo{1});

set(plotHandles(:,2), 'Marker', 's', 'Color', color_cell_exvivo{4});
set(plotHandles(:,2), 'Marker', 's',  'LineWidth', 1.5, ...
    'MarkerEdgeColor', color_cell_exvivo{5}, 'MarkerFaceColor' , color_cell_exvivo{2});


set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_avg16{4});
set(plotHandles(:,1), 'Marker', 'o', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_avg16{5}, 'MarkerFaceColor', color_cell_avg16{2});

set(plotHandles(:,3), 'Marker', '.', 'Color', color_cell_invivo{4});
set(plotHandles(:,3), 'Marker', '^', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_invivo{5}, 'MarkerFaceColor', color_cell_invivo{2});

xlim([0 20]); ylim([0 100]);
hold on;
xline(4.25);
yline(36);

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(FF_mean_illu, r2star_mean_illu, 1);
[r, p] = corrcoef(FF_mean_illu, r2star_mean_illu); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(FF_mean_illu, r2star_mean_illu, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(FF_mean_illu);
stats.SSE = sum((polyval(stats.polyCoefs, FF_mean_illu) - r2star_mean_illu).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:20;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
%axis off;




%%  Red
color_cell_gray = {[245, 245, 245]/255, [220, 220, 220]/255, [211, 211, 211]/255, [192, 192, 192]/255, [169, 169 ,169]/255};
plotHandles = zeros(4,3);
figure();
% figure('Position', [0 100 600 550]);
plotHandles(:,1) = scatter(FF_mean_illu_pp, r2star_mean_illu_pp, 96, 'filled', 'Color', color_cell_exvivo{1});
hold on;
plotHandles(:,2) = scatter(FF_mean_illu_np, r2star_mean_illu_np, 96, 'filled', 'Color', color_cell_avg16{1});
plotHandles(:,3) = scatter(FF_mean_illu_nn, r2star_mean_illu_nn, 96, 'filled', 'Color', color_cell_invivo{1});


set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_avg16{4});
set(plotHandles(:,1), 'Marker', 'o', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_avg16{5}, 'MarkerFaceColor', color_cell_avg16{2});

set(plotHandles(:,2), 'Marker', 's', 'Color', color_cell_gray{4});
set(plotHandles(:,2), 'Marker', 's',  'LineWidth', 1.5, ...
    'MarkerEdgeColor', color_cell_gray{5}, 'MarkerFaceColor' , color_cell_gray{2});

set(plotHandles(:,3), 'Marker', '.', 'Color', color_cell_gray{4});
set(plotHandles(:,3), 'Marker', '^', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_gray{5}, 'MarkerFaceColor', color_cell_gray{2});

xlim([0 20]); ylim([0 100]);
hold on;
xline(4.25);
yline(36);

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(FF_mean_illu_pp, r2star_mean_illu_pp, 1);
[r, p] = corrcoef(FF_mean_illu_pp, r2star_mean_illu_pp); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(FF_mean_illu_pp, r2star_mean_illu_pp, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(FF_mean_illu_pp);
stats.SSE = sum((polyval(stats.polyCoefs, FF_mean_illu_pp) - r2star_mean_illu_pp).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 4.3:1:20;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
%axis off;

%% Red T1 entropy vs FF
plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(FF_mean_illu_pp_v2, T1_entropy_illu_pp, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_avg16{4});
set(plotHandles(:,1), 'Marker', 'o', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_avg16{5}, 'MarkerFaceColor', color_cell_avg16{2});
xlim([0 20]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(FF_mean_illu_pp_v2, T1_entropy_illu_pp, 1);
[r, p] = corrcoef(FF_mean_illu_pp_v2, T1_entropy_illu_pp); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(FF_mean_illu_pp_v2, T1_entropy_illu_pp, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(FF_mean_illu_pp_v2);
stats.SSE = sum((polyval(stats.polyCoefs, FF_mean_illu_pp_v2) - T1_entropy_illu_pp).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:20;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;
%% Red T1 entropy vs R2star

plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(r2star_mean_illu_pp_v2, T1_entropy_illu_pp, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_avg16{4});
set(plotHandles(:,1), 'Marker', 'o', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_avg16{5}, 'MarkerFaceColor', color_cell_avg16{2});
xlim([0 80]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(r2star_mean_illu_pp_v2, T1_entropy_illu_pp, 1);
[r, p] = corrcoef(r2star_mean_illu_pp_v2, T1_entropy_illu_pp); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(r2star_mean_illu_pp_v2, T1_entropy_illu_pp, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(r2star_mean_illu_pp_v2);
stats.SSE = sum((polyval(stats.polyCoefs, r2star_mean_illu_pp_v2) - T1_entropy_illu_pp).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:80;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;

%% Red T1 entropy vs T2

plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(T2_mean_illu_pp, T1_entropy_illu_pp, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_avg16{4});
set(plotHandles(:,1), 'Marker', 'o', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_avg16{5}, 'MarkerFaceColor', color_cell_avg16{2});
xlim([0 80]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(T2_mean_illu_pp, T1_entropy_illu_pp, 1);
[r, p] = corrcoef(T2_mean_illu_pp, T1_entropy_illu_pp); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(T2_mean_illu_pp, T1_entropy_illu_pp, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(T2_mean_illu_pp);
stats.SSE = sum((polyval(stats.polyCoefs, T2_mean_illu_pp) - T1_entropy_illu_pp).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:80;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;
%% Blue
color_cell_gray = {[245, 245, 245]/255, [220, 220, 220]/255, [211, 211, 211]/255, [192, 192, 192]/255, [169, 169 ,169]/255};
plotHandles = zeros(4,3);
figure();
% figure('Position', [0 100 600 550]);
plotHandles(:,1) = scatter(FF_mean_illu_pp, r2star_mean_illu_pp, 96, 'filled', 'Color', color_cell_exvivo{1});
hold on;
plotHandles(:,2) = scatter(FF_mean_illu_np, r2star_mean_illu_np, 96, 'filled', 'Color', color_cell_avg16{1});
plotHandles(:,3) = scatter(FF_mean_illu_nn, r2star_mean_illu_nn, 96, 'filled', 'Color', color_cell_invivo{1});


set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_gray{4});
set(plotHandles(:,1), 'Marker', 'o', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_gray{5}, 'MarkerFaceColor', color_cell_gray{2});

set(plotHandles(:,2), 'Marker', 's', 'Color', color_cell_exvivo{4});
set(plotHandles(:,2), 'Marker', 's',  'LineWidth', 1.5, ...
    'MarkerEdgeColor', color_cell_exvivo{5}, 'MarkerFaceColor' , color_cell_exvivo{2});

set(plotHandles(:,3), 'Marker', '.', 'Color', color_cell_gray{4});
set(plotHandles(:,3), 'Marker', '^', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_gray{5}, 'MarkerFaceColor', color_cell_gray{2});

xlim([0 20]); ylim([0 100]);
hold on;
xline(4.25);
yline(36);

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(FF_mean_illu_np, r2star_mean_illu_np, 1);
[r, p] = corrcoef(FF_mean_illu_np, r2star_mean_illu_np); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(FF_mean_illu_np, r2star_mean_illu_np, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(FF_mean_illu_np);
stats.SSE = sum((polyval(stats.polyCoefs, FF_mean_illu_np) - r2star_mean_illu_np).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:0.2:4.3;
y = x .* stats.slope + stats.intercept;
plot(x, y, 'k', 'LineWidth', 2);
%axis off;

%% Blue T1 entropy vs FF
plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(FF_mean_illu_np_v2, T1_entropy_illu_np, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_exvivo{4});
set(plotHandles(:,1), 'Marker', 's', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_exvivo{5}, 'MarkerFaceColor', color_cell_exvivo{2});
xlim([0 20]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(FF_mean_illu_np_v2, T1_entropy_illu_np, 1);
[r, p] = corrcoef(FF_mean_illu_np_v2, T1_entropy_illu_np); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(FF_mean_illu_np_v2, T1_entropy_illu_np, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(FF_mean_illu_np_v2);
stats.SSE = sum((polyval(stats.polyCoefs, FF_mean_illu_np_v2) - T1_entropy_illu_np).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:20;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;

%% Blue T1 entropy vs R2star
plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(r2star_mean_illu_np_v2, T1_entropy_illu_np, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_exvivo{4});
set(plotHandles(:,1), 'Marker', 's', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_exvivo{5}, 'MarkerFaceColor', color_cell_exvivo{2});
xlim([0 80]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(r2star_mean_illu_np_v2, T1_entropy_illu_np, 1);
[r, p] = corrcoef(r2star_mean_illu_np_v2, T1_entropy_illu_np); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(r2star_mean_illu_np_v2, T1_entropy_illu_np, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(r2star_mean_illu_np_v2);
stats.SSE = sum((polyval(stats.polyCoefs, r2star_mean_illu_np_v2) - T1_entropy_illu_np).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:80;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;

%% Blue T1 entropy vs T2
plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(T2_mean_illu_np, T1_entropy_illu_np, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_exvivo{4});
set(plotHandles(:,1), 'Marker', 's', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_exvivo{5}, 'MarkerFaceColor', color_cell_exvivo{2});
xlim([0 80]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(T2_mean_illu_np, T1_entropy_illu_np, 1);
[r, p] = corrcoef(T2_mean_illu_np, T1_entropy_illu_np); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(T2_mean_illu_np, T1_entropy_illu_np, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(T2_mean_illu_np);
stats.SSE = sum((polyval(stats.polyCoefs, T2_mean_illu_np) - T1_entropy_illu_np).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:80;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;
%% Purple
color_cell_gray = {[245, 245, 245]/255, [220, 220, 220]/255, [211, 211, 211]/255, [192, 192, 192]/255, [169, 169 ,169]/255};
plotHandles = zeros(4,3);
figure();
% figure('Position', [0 100 600 550]);
plotHandles(:,1) = scatter(FF_mean_illu_pp, r2star_mean_illu_pp, 96, 'filled', 'Color', color_cell_exvivo{1});
hold on;
plotHandles(:,2) = scatter(FF_mean_illu_np, r2star_mean_illu_np, 96, 'filled', 'Color', color_cell_avg16{1});
plotHandles(:,3) = scatter(FF_mean_illu_nn, r2star_mean_illu_nn, 96, 'filled', 'Color', color_cell_invivo{1});


set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_gray{4});
set(plotHandles(:,1), 'Marker', 'o', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_gray{5}, 'MarkerFaceColor', color_cell_gray{2});

set(plotHandles(:,2), 'Marker', 's', 'Color', color_cell_gray{4});
set(plotHandles(:,2), 'Marker', 's',  'LineWidth', 1.5, ...
    'MarkerEdgeColor', color_cell_gray{5}, 'MarkerFaceColor' , color_cell_gray{2});

set(plotHandles(:,3), 'Marker', '.', 'Color', color_cell_invivo{4});
set(plotHandles(:,3), 'Marker', '^', 'LineWidth', 1.5, ...
    'MarkerEdgeColor',  color_cell_invivo{5}, 'MarkerFaceColor', color_cell_invivo{2});

xlim([0 20]); ylim([0 100]);
hold on;
xline(4.25);
yline(36);

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(FF_mean_illu_nn, r2star_mean_illu_nn, 1);
[r, p] = corrcoef(FF_mean_illu_nn, r2star_mean_illu_nn); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(FF_mean_illu_nn, r2star_mean_illu_nn, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(FF_mean_illu_nn);
stats.SSE = sum((polyval(stats.polyCoefs, FF_mean_illu_nn) - r2star_mean_illu_nn).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:0.2:4.3;
y = x .* stats.slope + stats.intercept;
plot(x, y, 'k', 'LineWidth', 2);
%axis off;


%% Purple T1 entropy vs FF
plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(FF_mean_illu_nn_v2, T1_entropy_illu_nn, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_invivo{4});
set(plotHandles(:,1), 'Marker', '^', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_invivo{5}, 'MarkerFaceColor', color_cell_invivo{2});
xlim([0 20]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(FF_mean_illu_nn_v2, T1_entropy_illu_nn, 1);
[r, p] = corrcoef(FF_mean_illu_nn_v2, T1_entropy_illu_nn); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(FF_mean_illu_nn_v2, T1_entropy_illu_nn, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(FF_mean_illu_nn_v2);
stats.SSE = sum((polyval(stats.polyCoefs, FF_mean_illu_nn_v2) - T1_entropy_illu_nn).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:20;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;

%% Purple T1 entropy vs R2star
plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(r2star_mean_illu_nn_v2, T1_entropy_illu_nn, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_invivo{4});
set(plotHandles(:,1), 'Marker', '^', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_invivo{5}, 'MarkerFaceColor', color_cell_invivo{2});
xlim([0 80]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(r2star_mean_illu_nn_v2, T1_entropy_illu_nn, 1);
[r, p] = corrcoef(r2star_mean_illu_nn_v2, T1_entropy_illu_nn); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(r2star_mean_illu_nn_v2, T1_entropy_illu_nn, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(r2star_mean_illu_nn_v2);
stats.SSE = sum((polyval(stats.polyCoefs, r2star_mean_illu_nn_v2) - T1_entropy_illu_nn).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:80;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;

%% Purple T1 entropy vs T2
plotHandles = zeros(4,1);
figure();
plotHandles(:,1) = scatter(T2_mean_illu_nn, T1_entropy_illu_nn, 96);
set(plotHandles(:,1), 'Marker', '.', 'Color', color_cell_invivo{4});
set(plotHandles(:,1), 'Marker', '^', 'LineWidth', 2, ...
    'MarkerEdgeColor',  color_cell_invivo{5}, 'MarkerFaceColor', color_cell_invivo{2});
xlim([0 80]); ylim([1 5]);
hold on;

stats = struct;
[stats.polyCoefs, stats.polyFitStruct] = polyfit(T2_mean_illu_nn, T1_entropy_illu_nn, 1);
[r, p] = corrcoef(T2_mean_illu_nn, T1_entropy_illu_nn); 
stats.r=r(1,2);
stats.r2 = stats.r^2;
[stats.rho, stats.rhoP] = corr(T2_mean_illu_nn, T1_entropy_illu_nn, 'type', 'Spearman');
stats.corrP = p(1,2);
stats.N = length(T2_mean_illu_nn);
stats.SSE = sum((polyval(stats.polyCoefs, T2_mean_illu_nn) - T1_entropy_illu_nn).^2);
stats.RMSE = sqrt(stats.SSE/(stats.N-2));
stats.slope = stats.polyCoefs(1);
stats.intercept = stats.polyCoefs(2);

x = 0:1:80;
y = x .* stats.slope + stats.intercept;
plot(x,y, 'k', 'LineWidth', 2);
axis square;


%% what is this?
labels = repmat(1, [1, length(T1_entropy)]);
% Baseline data with noise
data1 = cat(3, T2_mean(:));
data2 = cat(3, r2star_mean(:));

data1 = cat(3, r2star_mean(:));
data2 = cat(3, T2_mean(:));

% BA plot paramters
tit = 'T1 Entropy vs T2 Mean'; % figure title
gnames = {territories, states}; % names of groups in data {dimension 1 and 2}
label = {'T1-Entropy','T2 Mean','s-1'}; % Names of data sets
label = {'T2 Mean','T1-entropy','s-1'}; % Names of data sets

corrinfo = {'r2', 'P', 'eq'}; % stats to display of correlation scatter plot
BAinfo = {'RPC(%)','ks'}; % stats to display on Bland-ALtman plot
limits = 'auto'; % how to set the axes limits
if 0 % colors for the data sets may be set as:
	colors = 'br';      % character codes
else
	colors = [color_cell1{5};... % or RGB triplets
		      color_cell2{5}];
end
axesLimits = [2 6 0 100];
axesLimits = [0 100 0 100];
% Generate figure with symbols
[cr, fig, statsStruct] = BlandAltman_Customized(data1, data2,label,tit,gnames,'corrInfo',corrinfo,'baInfo',BAinfo,'axesLimits',limits,'colors',colors, 'showFitCI',' on', 'MarkerSize', 48, 'AxesLimits', axesLimits);
